
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>Utils - PyMultiTasking</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-pymultitaskingutils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="PyMultiTasking" class="md-header__button md-logo" aria-label="PyMultiTasking" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyMultiTasking
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utils
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/orcephrye/PyMultiTasking/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PyMultiTasking
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="PyMultiTasking" class="md-nav__button md-logo" aria-label="PyMultiTasking" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    PyMultiTasking
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/orcephrye/PyMultiTasking/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    PyMultiTasking
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      <label class="md-nav__link" for="__nav_2_1">
        Pymultitasking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Pymultitasking" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Pymultitasking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ThreadingUtils/" class="md-nav__link">
        Threadingutils
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Utils
      </a>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/orcephrye/PyMultiTasking/edit/main/reference/PyMultiTasking/utils.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="module-pymultitaskingutils">Module PyMultiTasking.utils</h1>
<h1 id="pymultitaskingtools-utilities">PyMultiTaskingTools Utilities</h1>
<p>This Python Package makes it easier to handle threads. This uses a schema of Task that is run by a Worker which is
managed in a Pool. The Pool uses a PriorityTaskQueue a custom class that inherits from PriorityQueue.</p>
<h2 id="summary-of-functions">Summary of Functions</h2>
<p>get_cpu_count() -&gt; int: <br />
    Return the number of Logic CPU Cores on the system</p>
<p>_async_raise(tid, exctype) -&gt; None: <br />
    Raises the exception, causing the thread to exit</p>
<p><a href="#wait_lock">wait_lock</a>(lock, timeout) -&gt; Iterator[bool]: <br />
    Meant to be used within a 'with' statement to throw an exception when timing out on a lock</p>
<p><a href="#method_wait">method_wait</a>(func, timeout=60, delay=0.1, incompleteVar=None, raiseExc=False, <em>args, </em>*kwargs): <br />
    Allows one to safely wait on a method to return.</p>
<h2 id="summary-of-classes">Summary of Classes</h2>
<p><a href="#Task">Task</a>(Event) <br />
    This is a wrapper class that inherits from an Event Object and is used inside the Worker. It is designed to hold
    the function ran and save the results of the function.</p>
<p><a href="#PriorityTaskQueue">PriorityTaskQueue</a>(PriorityQueue) <br />
    This is a simple override of the PriorityQueue class that ensures the 'item' is a Task class. It is meant to be used
    with ThreadingPool.</p>
<p><a href="#ProcessTaskQueue">ProcessTaskQueue</a>(JoinableQueue) <br />
    This is a simple override of the JoinableQueue class that ensures the 'item' is a Task class it is meant to be used
    with ProcessPool.</p>
<p><a href="#Worker">Worker</a> <br />
    This is designed to be managed by a Pool. It runs until told to stop and works tasks that come from a Queue
    maintained by the Pool. The Worker is meant to be a super class and only used to be inherited. It is the super
    class of either ThreadWorker or ProcessWorker.</p>
<p><a href="#Pool">Pool</a> <br />
    This manages a pool of Workers and a queue of Tasks. The workers consume tasks from the taskQueue until they are
    told to stop. This is meant to be a super class and only used to be inherited. It is the super class of either
    ThreadPool or ProcessPool.</p>
<p><a href="#MultipleEvents">MultipleEvents</a> <br />
    Designed to take multiple events and put them together to be waited on as a whole.</p>
<hr />
<details class="example"><summary>View Source</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">   1</span>
<span class="normal">   2</span>
<span class="normal">   3</span>
<span class="normal">   4</span>
<span class="normal">   5</span>
<span class="normal">   6</span>
<span class="normal">   7</span>
<span class="normal">   8</span>
<span class="normal">   9</span>
<span class="normal">  10</span>
<span class="normal">  11</span>
<span class="normal">  12</span>
<span class="normal">  13</span>
<span class="normal">  14</span>
<span class="normal">  15</span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="c1"># -*- coding=utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd"># PyMultiTaskingTools Utilities</span>

<span class="sd">This Python Package makes it easier to handle threads. This uses a schema of Task that is run by a Worker which is</span>

<span class="sd">managed in a Pool. The Pool uses a PriorityTaskQueue a custom class that inherits from PriorityQueue.</span>

<span class="sd">## Summary of Functions</span>

<span class="sd">get_cpu_count() -&gt; int: &lt;br /&gt;</span>

<span class="sd">    Return the number of Logic CPU Cores on the system</span>

<span class="sd">_async_raise(tid, exctype) -&gt; None: &lt;br /&gt;</span>

<span class="sd">    Raises the exception, causing the thread to exit</span>

<span class="sd">[wait_lock](#wait_lock)(lock, timeout) -&gt; Iterator[bool]: &lt;br /&gt;</span>

<span class="sd">    Meant to be used within a &#39;with&#39; statement to throw an exception when timing out on a lock</span>

<span class="sd">[method_wait](#method_wait)(func, timeout=60, delay=0.1, incompleteVar=None, raiseExc=False, *args, **kwargs): &lt;br /&gt;</span>

<span class="sd">    Allows one to safely wait on a method to return.</span>

<span class="sd">## Summary of Classes</span>

<span class="sd">[Task](#Task)(Event) &lt;br /&gt;</span>

<span class="sd">    This is a wrapper class that inherits from an Event Object and is used inside the Worker. It is designed to hold</span>

<span class="sd">    the function ran and save the results of the function.</span>

<span class="sd">[PriorityTaskQueue](#PriorityTaskQueue)(PriorityQueue) &lt;br /&gt;</span>

<span class="sd">    This is a simple override of the PriorityQueue class that ensures the &#39;item&#39; is a Task class. It is meant to be used</span>

<span class="sd">    with ThreadingPool.</span>

<span class="sd">[ProcessTaskQueue](#ProcessTaskQueue)(JoinableQueue) &lt;br /&gt;</span>

<span class="sd">    This is a simple override of the JoinableQueue class that ensures the &#39;item&#39; is a Task class it is meant to be used</span>

<span class="sd">    with ProcessPool.</span>

<span class="sd">[Worker](#Worker) &lt;br /&gt;</span>

<span class="sd">    This is designed to be managed by a Pool. It runs until told to stop and works tasks that come from a Queue</span>

<span class="sd">    maintained by the Pool. The Worker is meant to be a super class and only used to be inherited. It is the super</span>

<span class="sd">    class of either ThreadWorker or ProcessWorker.</span>

<span class="sd">[Pool](#Pool) &lt;br /&gt;</span>

<span class="sd">    This manages a pool of Workers and a queue of Tasks. The workers consume tasks from the taskQueue until they are</span>

<span class="sd">    told to stop. This is meant to be a super class and only used to be inherited. It is the super class of either</span>

<span class="sd">    ThreadPool or ProcessPool.</span>

<span class="sd">[MultipleEvents](#MultipleEvents) &lt;br /&gt;</span>

<span class="sd">    Designed to take multiple events and put them together to be waited on as a whole.</span>

<span class="sd">---</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">multiprocessing</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">traceback</span>

<span class="kn">import</span> <span class="nn">inspect</span>

<span class="kn">import</span> <span class="nn">uuid</span>

<span class="kn">import</span> <span class="nn">ctypes</span>

<span class="kn">from</span> <span class="nn">queue</span> <span class="kn">import</span> <span class="n">PriorityQueue</span><span class="p">,</span> <span class="n">Empty</span><span class="p">,</span> <span class="n">Queue</span>

<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Manager</span>

<span class="kn">from</span> <span class="nn">multiprocessing.queues</span> <span class="kn">import</span> <span class="n">JoinableQueue</span>

<span class="kn">from</span> <span class="nn">multiprocessing.synchronize</span> <span class="kn">import</span> <span class="n">RLock</span><span class="p">,</span> <span class="n">SemLock</span>

<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">RLock</span> <span class="k">as</span> <span class="n">MultiProcRLock</span>

<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>

<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Lock</span><span class="p">,</span> <span class="n">RLock</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Semaphore</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">wraps</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span>

<span class="c1"># logging.basicConfig(format=&#39;%(asctime)s %(levelname)s %(name)s %(funcName)s %(lineno)s %(message)s&#39;,</span>

<span class="c1">#                     level=logging.DEBUG)</span>

<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;MultiTaskingTools&#39;</span><span class="p">)</span>

<span class="n">__STARTING__</span> <span class="o">=</span> <span class="s2">&quot;__STARTING__&quot;</span>

<span class="n">__STOPPING__</span> <span class="o">=</span> <span class="s2">&quot;__STOPING__&quot;</span>

<span class="n">__ACTIVE__</span> <span class="o">=</span> <span class="s2">&quot;__ACTIVE__&quot;</span>

<span class="n">__INACTIVE__</span> <span class="o">=</span> <span class="s2">&quot;__INACTIVE__&quot;</span>

<span class="n">__STOPPED__</span> <span class="o">=</span> <span class="s2">&quot;__STOPPED__&quot;</span>

<span class="n">__THREADPOOL_STATES__</span> <span class="o">=</span> <span class="p">{</span><span class="n">__STARTING__</span><span class="p">:</span> <span class="n">__STARTING__</span><span class="p">,</span> <span class="n">__STOPPING__</span><span class="p">:</span> <span class="n">__STOPPING__</span><span class="p">,</span> <span class="n">__ACTIVE__</span><span class="p">:</span> <span class="n">__ACTIVE__</span><span class="p">,</span>

                         <span class="n">__INACTIVE__</span><span class="p">:</span> <span class="n">__INACTIVE__</span><span class="p">,</span> <span class="n">__STOPPED__</span><span class="p">:</span> <span class="n">__STOPPED__</span><span class="p">}</span>

<span class="n">_DEFAULT_MAX_WORKERS</span> <span class="o">=</span> <span class="mi">4</span>

<span class="k">def</span> <span class="nf">dummy_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_default&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">__async_raise</span><span class="p">(</span><span class="n">tid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exctype</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="ne">SystemExit</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Raises the exception, causing the thread to exit&quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pythonapi</span><span class="o">.</span><span class="n">PyThreadState_SetAsyncExc</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">tid</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">py_object</span><span class="p">(</span><span class="n">exctype</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid thread ID&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">res</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">ctypes</span><span class="o">.</span><span class="n">pythonapi</span><span class="o">.</span><span class="n">PyThreadState_SetAsyncExc</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">tid</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;PyThreadState_SetAsyncExc failed&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_cpu_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Return the number of Logic CPU Cores on the system&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">cpu_count</span>

        <span class="k">return</span> <span class="n">cpu_count</span><span class="p">()</span>

    <span class="k">except</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">_DEFAULT_MAX_WORKERS</span>

<span class="nd">@contextmanager</span>

<span class="k">def</span> <span class="nf">wait_lock</span><span class="p">(</span><span class="n">lock</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">blocking</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">raise_exc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;method_wait&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        Meant to be used within a &#39;with&#39; statement to throw an exception when timing out on a lock</span>

<span class="sd">    - :param lock: (Lock/RLock/Semephore) the lock that will be acquired or an exception will be thrown</span>

<span class="sd">    - :param timeout: The amount of time to wait on attempting to gain lock.</span>

<span class="sd">    - :return: (generator of bools) This is used with a contextmanager decorator</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span> <span class="n">SemLock</span><span class="p">):</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="n">blocking</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">raise_exc</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The Lock was unable to be obtained within the timeout: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">timeout</span><span class="p">)</span>

    <span class="k">yield</span> <span class="n">result</span>

    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>

        <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">safe_acquire</span><span class="p">(</span><span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Lock</span><span class="p">,</span> <span class="n">RLock</span><span class="p">],</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;safe_acquire&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        Meant to be used as a safe way to wait on a lock. Returns False if time runs out.</span>

<span class="sd">    - :param lock: (Lock/RLock) the lock that will be acquired or return False</span>

<span class="sd">    - :param timeout: The amount of time to wait on attempting to gain lock.</span>

<span class="sd">    - :return: bools</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">timeout</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR in safe_acquire with timeout </span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[DEBUG] for safe_acquire: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">safe_release</span><span class="p">(</span><span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Lock</span><span class="p">,</span> <span class="n">RLock</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;&lt;a name=&quot;safe_acquire&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        Meant to be used as a safe way to release a lock. Returns False if the lock has already been released.</span>

<span class="sd">    - :param lock: (Lock/RLock) the lock that will be acquired or return False</span>

<span class="sd">    - :return: bools</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR in safe_release: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[DEBUG] for safe_release: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">method_wait</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">delayPercent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>

                <span class="n">delayAscending</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">incompleteVar</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

                <span class="n">raiseExc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;method_wait&quot;&gt;&lt;/a&gt;Allows one to safely wait on a method to return.</span>

<span class="sd">    - *func*: (callable) Function to be executed using the method wait</span>

<span class="sd">    - *timeout*: (int, default 60) Amount of time to wait until giving up on the function</span>

<span class="sd">    - *delay*: (int or float, default 0.1) Amount of time to pause inbetween asking the function for results</span>

<span class="sd">    - *incompleteVar*: (any) Variable that indicates the function is not yet finished</span>

<span class="sd">    - *raiseExc*: (bool, default False) Causes methodWait to raise an exception instead of returning None</span>

<span class="sd">    - *args*: args that will be passed to the function</span>

<span class="sd">    - *kwargs*: kwargs that will be passed to the function</span>

<span class="sd">    - *return* could be anything</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ascending_helper</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">multipler</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">num</span> <span class="o">*</span> <span class="n">multipler</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">yield</span> <span class="n">num</span> <span class="o">*</span> <span class="n">multipler</span>

            <span class="k">yield</span> <span class="n">ascending_helper</span><span class="p">(</span><span class="n">num</span> <span class="o">*</span> <span class="n">multipler</span><span class="p">,</span> <span class="n">multipler</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">yield</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">delay_ascender</span><span class="p">(</span><span class="n">time_delay</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_delay</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">time_delay</span>

    <span class="k">def</span> <span class="nf">delay_by_time</span><span class="p">(</span><span class="n">time_delay</span><span class="p">):</span>

        <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">time_delay</span>

    <span class="k">def</span> <span class="nf">delay_by_percent</span><span class="p">(</span><span class="n">time_delay</span><span class="p">):</span>

        <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">*</span> <span class="n">time_delay</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">time_delay</span>

    <span class="n">rawKwargs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">rawKwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;failureVar&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">delayPercent</span> <span class="ow">and</span> <span class="n">delayAscending</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">delayer</span> <span class="o">=</span> <span class="n">delay_by_percent</span>

    <span class="k">elif</span> <span class="n">delayAscending</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

        <span class="n">delay</span> <span class="o">=</span> <span class="p">[</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">ascending_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">delay</span><span class="p">)]</span>

        <span class="n">delayer</span> <span class="o">=</span> <span class="n">delay_ascender</span>

    <span class="k">elif</span> <span class="n">delayAscending</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

        <span class="n">delay</span> <span class="o">=</span> <span class="p">[</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">ascending_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">delay</span><span class="p">)]</span>

        <span class="n">delay</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">delayer</span> <span class="o">=</span> <span class="n">delay_ascender</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">delayer</span> <span class="o">=</span> <span class="n">delay_by_time</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="n">current_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">timeout</span><span class="p">:</span>

            <span class="n">results</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;failureVar&#39;</span> <span class="ow">in</span> <span class="n">rawKwargs</span> <span class="ow">and</span> <span class="n">rawKwargs</span><span class="p">[</span><span class="s1">&#39;failureVar&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">results</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">results</span>

            <span class="k">elif</span> <span class="n">results</span> <span class="o">==</span> <span class="n">incompleteVar</span><span class="p">:</span>

                <span class="n">delay</span> <span class="o">=</span> <span class="n">delayer</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>

                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">incompleteVar</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">results</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The function </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s1"> has thrown an exception. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[DEBUG]: trace for error: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">raiseExc</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">,</span> <span class="ne">BaseException</span><span class="p">):</span>

            <span class="k">raise</span> <span class="n">raiseExc</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The function </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s1"> has thrown an exception. </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>

            <span class="k">raise</span> <span class="n">raiseExc</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">return</span> <span class="n">e</span>

    <span class="k">return</span> <span class="n">incompleteVar</span>

<span class="c1"># noinspection PyPep8Naming</span>

<span class="k">def</span> <span class="nf">Limiter</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; This is a decorator designed to decorate Threaded and Proccessed decorators to limit the number of</span>

<span class="sd">        simultaneous calls.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sem</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>

        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">wrapped</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">blocking</span><span class="p">:</span>

                <span class="k">with</span> <span class="n">sem</span><span class="p">:</span>

                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;_task_semaphore&#39;</span><span class="p">:</span> <span class="n">sem</span><span class="p">})</span>

                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">wrapped</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">class</span> <span class="nc">PriorityTaskQueue</span><span class="p">(</span><span class="n">PriorityQueue</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;PriorityTaskQueue&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        This is a simple override of the PriorityQueue class that ensures the &#39;item&#39; is a Task class meant to be used</span>

<span class="sd">        ONLY in ThreadingPool</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">put_nowait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Task</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Task</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ProcessTaskQueue</span><span class="p">(</span><span class="n">JoinableQueue</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;ProcessTaskQueue&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        This is a simple override of the JoinableQueue class that ensures the &#39;item&#39; is a Task class meant to be used</span>

<span class="sd">        ONLY in ProcessingPool</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ProcessTaskQueue</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="n">maxsize</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span> <span class="ow">or</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">get_context</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">put_nowait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Task</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Task</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">__PyMultiDec</span><span class="p">:</span>

    <span class="n">wType</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">pType</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;making Class Dec: args=</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1"> - kwargs=</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callback_func</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback_func&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kwargsLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;daemon&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span> <span class="o">=</span> <span class="n">PriorityTaskQueue</span><span class="p">()</span>

                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;_worker_workerAutoKill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;_worker_personalQue&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span><span class="p">})</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wType</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span>

                                         <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">)})</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">worker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="s1">&#39;task_queue&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pool_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pType</span><span class="o">.</span><span class="n">get_pool_by_name</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pool_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>

                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;_pool_workerAutoKill&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;_pool_name&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pool_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)})</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pType</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_pool_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

                                                                     <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_pool_&#39;</span><span class="p">)})</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;calling test_dec: args=</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1"> - kwargs=</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="nd">@wraps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>

            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Within wrapper: args=</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1"> - kwargs=</span><span class="si">{</span><span class="n">kw</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_task_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_task_&#39;</span><span class="p">)})</span>

            <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_task_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_task_&#39;</span><span class="p">)}</span>

            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>

                <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_task_&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>

            <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;callback_func&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback_func</span><span class="p">})</span>

            <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">killed</span><span class="p">:</span>

                    <span class="n">_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decorated Worker </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="si">}</span><span class="s1"> was killed no longer daemon for func </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">wType</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span>

                                               <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">)})</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">personal_que</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">submit_task_nowait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">submit_task_autospawn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_restart</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">wType</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span>

                                           <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_worker_&#39;</span><span class="p">)})</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">task</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">wrapper</span>

        <span class="k">return</span> <span class="n">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Task</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;Task&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        This is a wrapper class that inherits from an Event Object and is used inside the Worker.</span>

<span class="sd">        It is designed to hold the function ran and save the results of the function.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaultriority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kill</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">inject_task</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>

                 <span class="n">store_return</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ignore_queue</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">callback_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

                 <span class="n">semaphore</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Semaphore</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kill</span> <span class="o">=</span> <span class="n">kill</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_queue</span> <span class="o">=</span> <span class="n">ignore_queue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callback_fun</span> <span class="o">=</span> <span class="n">callback_func</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">semaphore</span> <span class="o">=</span> <span class="n">semaphore</span> <span class="k">if</span> <span class="n">semaphore</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Semaphore</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">partial</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">inject_task</span> <span class="ow">and</span> <span class="n">Task</span><span class="o">.</span><span class="n">__inspect_kwargs</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">func</span><span class="p">):</span>

                <span class="n">fn</span><span class="o">.</span><span class="n">keywords</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;TaskObject&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="p">})</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">fn</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">inject_task</span> <span class="ow">and</span> <span class="n">Task</span><span class="o">.</span><span class="n">__inspect_kwargs</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;TaskObject&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="p">})</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">store_return</span> <span class="o">=</span> <span class="n">store_return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span> <span class="o">=</span> <span class="n">MultiProcRLock</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__worker</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__results</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This is used to run the stored partial function and store the results.</span>

<span class="sd">        - :param args: Positional arguments to be passed to the task.</span>

<span class="sd">        - :param kwargs: Keyword arguments to be passed to the task</span>

<span class="sd">        - :return: (Anything)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>

            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;A Task Object cannot be ran more than once!&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">semaphore</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_return</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback_fun</span><span class="p">:</span>

                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback_fun</span><span class="p">:</span>

                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1"> failed&#39;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1"> succeeded&#39;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">semaphore</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store_return</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>

            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;A Task Object cannot be cleared once set!&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Task</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>

    <span class="k">def</span> <span class="nf">__inspect_kwargs</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="s1">&#39;TaskObject&#39;</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">keyword</span> <span class="o">==</span> <span class="n">key</span> <span class="ow">or</span> <span class="s1">&#39;kwargs&#39;</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Task(UUID=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1">,Priority=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="si">}</span><span class="s1">): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">func</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Task</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">priority</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Task</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">priority</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Task</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">priority</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Task</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">priority</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">acquired</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">acquired</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__worker</span>

    <span class="nd">@worker</span><span class="o">.</span><span class="n">setter</span>

    <span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__worker</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@worker</span><span class="o">.</span><span class="n">deleter</span>

    <span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__worker</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">acquired</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">acquired</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__results</span>

    <span class="nd">@results</span><span class="o">.</span><span class="n">setter</span>

    <span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__results</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@results</span><span class="o">.</span><span class="n">deleter</span>

    <span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__updateRLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">raise_exc</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__results</span>

<span class="k">class</span> <span class="nc">Worker</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;Worker&quot;&gt;&lt;/a&gt;</span>

<span class="sd">            This is designed to be managed by a ThreadPool. However, it can run on its own as well. It runs until told to</span>

<span class="sd">            stop and works tasks that come from a the PriorityTaskQueue maintained by the Pool.</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="n">__workerAutoKill</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">__defaultTimeout</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">workerType</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Pool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">defaultTimeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>

                 <span class="n">personalQue</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ProcessTaskQueue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

                 <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">daemon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">_log</span> <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">log</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__defaultTimeout</span> <span class="o">=</span> <span class="n">defaultTimeout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="n">defaultTimeout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__personalQue</span> <span class="o">=</span> <span class="n">personalQue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

            <span class="n">target</span> <span class="o">=</span> <span class="n">Task</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">kill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Worker</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">name</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="n">daemon</span><span class="p">,</span>

                                     <span class="n">args</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="p">()),</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kwargs&#39;</span><span class="p">,</span> <span class="p">{}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">pool</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span> <span class="o">=</span> <span class="n">workerAutoKill</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__personalQue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">pool</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[INFO]: Starting new </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Worker: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s1"> for Pool: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">safe_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># noinspection PyUnresolvedReferences</span>

    <span class="k">def</span> <span class="nf">get_next_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Task</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>

        <span class="sd">&quot;&quot;&quot; This gets the next Task in the taskQueue</span>

<span class="sd">        - :return: (Task)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="bp">self</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">kill</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">ignore_queue</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__personalQue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="bp">self</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span>

        <span class="k">except</span> <span class="n">Empty</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="o">.</span><span class="n">__KILL__</span><span class="p">,</span> <span class="n">kill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_queue</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: Error in getting task: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[DEBUG]: trace for error in getting task: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This is an override of the run method within Thread that loops constantly waiting on another task.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">killed</span><span class="p">:</span>

                <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_task</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">task</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;task is None an error occurred in get_next_task method closing the thread&#39;</span><span class="p">)</span>

                    <span class="k">break</span>

                <span class="k">elif</span> <span class="n">task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The task is: </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="kc">None</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">ignore_queue</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">kill</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Killing thread once task is complete: </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: While Worker thread is running with task: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="si">}</span><span class="s1"> Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[DEBUG]: trace for error: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">isSet</span><span class="p">():</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">ignore_queue</span><span class="p">:</span>

                        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="p">,</span> <span class="s1">&#39;task_done&#39;</span><span class="p">,</span> <span class="n">dummy_func</span><span class="p">)()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">finally</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>

    <span class="k">def</span> <span class="nf">__KILL__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">pass</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">task_queue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__personalQue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__personalQue</span>

        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s1">&#39;taskQueue&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This property will return 0 if it thinks it doesn&#39;t need to run any longer and is ready to self terminate</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">killed</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span>

                                        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">//=</span> <span class="mi">2</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__defaultTimeout</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__defaultTimeout</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">current_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This changes to the priority of each incoming task. &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span><span class="o">.</span><span class="n">priority</span>

            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This determines if the Worker currently has a Task to work. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__currentTask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="c1"># noinspection PyPep8Naming</span>

<span class="k">class</span> <span class="nc">Pool</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;ThreadPool&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        This manages a pool of Workers and a queue of Tasks. The workers consume tasks from the taskQueue until they</span>

<span class="sd">        are told to stop.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_state</span> <span class="o">=</span> <span class="n">__INACTIVE__</span>

    <span class="n">__regRLock</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">__pool_registry</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workerType</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">maxWorkers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tasks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Queue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

                 <span class="n">daemon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">prepopulate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">workerType</span> <span class="o">=</span> <span class="n">workerType</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">_log</span> <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">log</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">uuid</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span> <span class="o">=</span> <span class="n">maxWorkers</span> <span class="ow">or</span> <span class="n">get_cpu_count</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span> <span class="o">=</span> <span class="n">workerAutoKill</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span> <span class="o">=</span> <span class="n">RLock</span><span class="p">()</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span> <span class="s1">&#39;workerType&#39;</span><span class="p">,</span> <span class="s1">&#39;THREAD&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;THREAD&#39;</span> <span class="k">else</span> <span class="n">MultiProcRLock</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span> <span class="o">=</span> <span class="n">RLock</span><span class="p">()</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span> <span class="s1">&#39;workerType&#39;</span><span class="p">,</span> <span class="s1">&#39;THREAD&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;THREAD&#39;</span> <span class="k">else</span> <span class="n">MultiProcRLock</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span> <span class="o">=</span> <span class="n">RLock</span><span class="p">()</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span> <span class="s1">&#39;workerType&#39;</span><span class="p">,</span> <span class="s1">&#39;THREAD&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;THREAD&#39;</span> <span class="k">else</span> <span class="n">MultiProcRLock</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span> <span class="o">=</span> <span class="n">tasks</span> <span class="ow">or</span> <span class="n">PriorityTaskQueue</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__STARTING__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="n">daemon</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignoredTasks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">prepopulate</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">setup_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="o">=</span><span class="n">prepopulate</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">setup_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span>

                                                                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">,</span>

                               <span class="n">workerAutoKill</span><span class="o">=</span><span class="ow">not</span> <span class="n">daemon</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">daemon</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__ACTIVE__</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR in __exit__ of Pool: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[DEBUG] for __exit__ of Pool: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Pool(UUID=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s1">, State=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="nf">setup_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numOfWorkers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

                      <span class="n">allow_restart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Generally only used by init. This setups Worker threads to be managed by the Pool.</span>

<span class="sd">        - :param numOfWorkers: (int) Number workers setup. IF the number of workers is higher then the value of</span>

<span class="sd">                &#39;maxWorkers&#39; then &#39;maxWorkers&#39; is updated. The numOfWorkers is how many Workers the Pool has *not* now</span>

<span class="sd">                many new Workers get added.</span>

<span class="sd">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="sd">                the &#39;taskQueue&#39;.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">in</span> <span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span> <span class="n">__STOPPED__</span><span class="p">)</span> <span class="ow">and</span> <span class="n">allow_restart</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">numOfWorkers</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_max_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="p">)</span>

            <span class="n">numOfNewWorkers</span> <span class="o">=</span> <span class="p">(</span><span class="n">numOfWorkers</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">numOfWorkers</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">):</span>

            <span class="n">numOfNewWorkers</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">numOfNewWorkers</span> <span class="o">=</span> <span class="n">numOfWorkers</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">numOfNewWorkers</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_worker</span><span class="p">(</span><span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span> <span class="k">if</span> <span class="n">workerAutoKill</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">workerAutoKill</span><span class="p">,</span>

                            <span class="n">allow_restart</span><span class="o">=</span><span class="n">allow_restart</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">numOfNewWorkers</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">add_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_restart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Adds a single new worker too the Pool.</span>

<span class="sd">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to add new worker!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">in</span> <span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span> <span class="n">__STOPPED__</span><span class="p">)</span> <span class="ow">and</span> <span class="n">allow_restart</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workerType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span> <span class="k">if</span> <span class="n">workerAutoKill</span> <span class="ow">is</span> <span class="kc">None</span>

                                                                                       <span class="k">else</span> <span class="n">workerAutoKill</span><span class="p">))</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">remove_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workerTooRemove</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Worker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>

                      <span class="n">allow_abandon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Removes a single new worker from the Pool. This can be called to remove the last Worker or you can</span>

<span class="sd">            specify a Worker to remove.</span>

<span class="sd">        - :param workerTooRemove: (Worker) This is usually sent when a Worker is self terminating</span>

<span class="sd">        - :param timeout: (int) 30, How much time it is willing to wait. NOTE: This is doubled when specifying a</span>

<span class="sd">            worker with the workerTooRemove parameter.</span>

<span class="sd">        - :param allow_abandon: (bool) False, This determines if the thread will simply be abandoned if it cannot</span>

<span class="sd">            normally remove it from the pool. It will only do this if &#39;safe_stop&#39; and &#39;terminate&#39; methods fail.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">wait_helper</span><span class="p">(</span><span class="n">wait_time</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">ev</span><span class="p">,</span> <span class="n">wtr</span><span class="p">):</span>

            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">wait_time</span> <span class="ow">and</span> <span class="n">wtr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">:</span>

                <span class="n">ev</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">wtr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">workerTooRemove</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="ow">and</span> <span class="n">workerTooRemove</span><span class="o">.</span><span class="n">killed</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span>

                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">workerTooRemove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">workerTooRemove</span><span class="o">.</span><span class="n">safe_stop</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">(),</span> <span class="n">e</span><span class="p">,</span> <span class="n">workerTooRemove</span><span class="p">):</span>

                    <span class="k">return</span> <span class="kc">True</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[WARN]: worker(</span><span class="si">{</span><span class="n">workerTooRemove</span><span class="si">}</span><span class="s1">) needs to be terminated in order to be removed.&#39;</span><span class="p">)</span>

                <span class="nb">getattr</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">,</span> <span class="s1">&#39;terminate&#39;</span><span class="p">,</span> <span class="n">dummy_func</span><span class="p">)()</span>

                <span class="k">if</span> <span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">(),</span> <span class="n">e</span><span class="p">,</span> <span class="n">workerTooRemove</span><span class="p">):</span>

                    <span class="k">return</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">allow_abandon</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[WARN]: worker(</span><span class="si">{</span><span class="n">workerTooRemove</span><span class="si">}</span><span class="s1">) is being abandoned.&#39;</span><span class="p">)</span>

                    <span class="n">worker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">worker</span><span class="o">.</span><span class="n">killed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>

                        <span class="n">worker</span><span class="o">.</span><span class="n">killed</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">return</span> <span class="kc">True</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">current_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="o">.</span><span class="n">__KILL__</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highest_priority</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kill</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>

                            <span class="n">submit_task_autospawn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="n">current</span> <span class="o">=</span> <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

                    <span class="k">while</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">start</span> <span class="o">+</span> <span class="n">timeout</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;=</span> <span class="n">current_num</span><span class="p">:</span>

                        <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&lt;</span> <span class="n">current_num</span>

                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: Error occurred while attempting to remove worker: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[DEBUG]: Trace for error while attempting to remove worker: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">finally</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__INACTIVE__</span>

    <span class="k">def</span> <span class="nf">set_max_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxWorkers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Set the maximum number of threads that will remain active. Return the maximum thread limit.</span>

<span class="sd">        - :param maxWorkers: (int) Max thread limit</span>

<span class="sd">        - :return: (int)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">maxWorkers</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="ow">and</span> <span class="n">maxWorkers</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span> <span class="o">=</span> <span class="n">maxWorkers</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span>

    <span class="k">def</span> <span class="nf">wait_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">delay</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This method waits until all Tasks in the PriorityTaskQueue is done. If the parameter block is True it will</span>

<span class="sd">            stop any new Task from being submitted while waiting.</span>

<span class="sd">        - :param timeout: (int/float) How long to wait for all tasks in the &#39;taskQueue&#39; to be finished.</span>

<span class="sd">        - :param delay: (int/float) The amount of time to wait before checking again in seconds. Default 0.1.</span>

<span class="sd">        - :param block: (bool) This will stop new tasks from being submitted to the Queue until finished.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_wait_completion</span><span class="p">(</span><span class="n">waitTime</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

            <span class="n">current_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">waitTime</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">return</span> <span class="kc">True</span>

                <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">block</span><span class="p">:</span>

            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span>

                <span class="k">return</span> <span class="n">_wait_completion</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">timeout</span><span class="p">)</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()))</span>

        <span class="k">return</span> <span class="n">_wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unsafe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This sends a kill operation too all the workers and waits for them to complete and then removes the threads.</span>

<span class="sd">            It can also attempt to kill Workers in an unsafe way with the &#39;terminate&#39; Worker method.</span>

<span class="sd">        - :param timeout: (int) The length of time to wait on tasks to be stopped</span>

<span class="sd">        - :param unsafe: (bool/None) True: The &#39;terminate&#39; method will be called on each Worker. False: Even if the</span>

<span class="sd">                timeout is reached the &#39;terminate&#39; method will *not* be called. None: This will attempt to safely wait</span>

<span class="sd">                for the Workers too finish but if timeout is reached then the &#39;terminate&#39; method will be called.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__STOPPING__</span>

        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span>

        <span class="k">def</span> <span class="nf">_clear_helper</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">task</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">func</span> <span class="o">!=</span> <span class="n">Worker</span><span class="o">.</span><span class="n">__KILL__</span>

        <span class="k">def</span> <span class="nf">_clear_shutdown_tasks</span><span class="p">():</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>

                    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">_clear_helper</span><span class="p">,</span> <span class="n">tasks</span><span class="p">):</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">ignoredTasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[ERROR]: Error while clearing old tasks: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[DEBUG]: Trace for error clearing old tasks: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_unsafe_shutdown</span><span class="p">():</span>

            <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Worker: </span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s1"> will be killed unsafely.&#39;</span><span class="p">)</span>

                <span class="n">worker</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">unsafe</span><span class="p">:</span>

            <span class="n">_unsafe_shutdown</span><span class="p">()</span>

            <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">while</span> <span class="n">current_time</span> <span class="o">&lt;</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">timeout</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are no more workers. No need for forced timeout&#39;</span><span class="p">)</span>

                    <span class="k">break</span>

                <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">unsafe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">_unsafe_shutdown</span><span class="p">()</span>

                <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

            <span class="n">_clear_shutdown_tasks</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__STOPPED__</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This first calls &#39;waitCompletion&#39; with &#39;block=True&#39; and then calls &#39;shutdown&#39;. The goal is to try to wait</span>

<span class="sd">            for all Tasks to complete and then close out the Pool.</span>

<span class="sd">        - :param timeout: (int)The length of time to wait on both join and shutdown.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span>

            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">timeout</span> <span class="o">-</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">),</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; A simple mapping tool that takes different params (a List of tuples formatted like [(*args, **kwargs)]) and</span>

<span class="sd">            pass them too a function. chunksize determines how too break up the list and distribute it across Workers.</span>

<span class="sd">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="sd">        - :param params: (Tuple) The Tuple should be formatted like so ( ((arg1, ), {&#39;kwarg1&#39;: &#39;value&#39;}), ...). Each</span>

<span class="sd">                item within the Tuple is a Tuple itself with two items. The first item is positional arguments (args)</span>

<span class="sd">                and the second item is keyword arguments (kwargs). Even if they are empty they need to exist.</span>

<span class="sd">        - :param chunksize: (int) If left at 0 the method will attempt to spread the tasks as evenly as possible.</span>

<span class="sd">                Otherwise it will take the number to mean how many Tasks will be given to a single Worker.</span>

<span class="sd">        - :param kwargs: These are keyword arguments that get passed to the &#39;submit&#39; method.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;submit_task_autospawn&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>

            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">chunksize</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span>

                <span class="n">chunksize</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">chunksize</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">chunkHelper</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">chunkList</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">parms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">parms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">parms</span> <span class="ow">in</span> <span class="n">chunkList</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">listIntoChunks</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">chunksize</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">chunksize</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">+</span> <span class="n">chunksize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">chunksize</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">listIntoChunks</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">chunkHelper</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">chunkList</span><span class="o">=</span><span class="n">item</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Task</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>

        <span class="sd">&quot;&quot;&quot; This is the function used to submit a Task to the Pool. Simply provide a function as &#39;fn&#39; and then</span>

<span class="sd">            arguments that need to be passed too that function and it will create a Task and add it to the</span>

<span class="sd">            PriorityTaskQueue to be worked.</span>

<span class="sd">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="sd">        - :param args: These args will be passed to the Task object.</span>

<span class="sd">        - :param kwargs: The following keywords will be pulled out. &#39;submit_task_nowait&#39;, &#39;submit_task_timeout&#39;,</span>

<span class="sd">                &#39;submit_task_autospawn&#39;, &#39;submit_task_priority&#39;. All others will be passed to Task.</span>

<span class="sd">            + &#39;submit_task_nowait&#39;: (bool) tells &#39;submit&#39; to use the &#39;put_nowait&#39; method on PriorityTaskQueue.</span>

<span class="sd">            + &#39;submit_task_timeout&#39;: (int/float) how long should one wait too submit.</span>

<span class="sd">            + &#39;submit_task_autospawn&#39;: (bool/None) determines if new Worker should be spawned because of more tasks.</span>

<span class="sd">            + &#39;submit_task_priority&#39;: (int) changes the priority of the task.</span>

<span class="sd">        - :return: (Task/bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">def</span> <span class="nf">autospawn_parser</span><span class="p">(</span><span class="n">tmpAutospawn</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">__STOPPING__</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">==</span> <span class="n">__STOPPED__</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_workers</span> <span class="ow">and</span> <span class="n">tmpAutospawn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">return</span> <span class="n">tmpAutospawn</span>

        <span class="n">nowait</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_nowait&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_timeout&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">autospawn</span> <span class="o">=</span> <span class="n">autospawn_parser</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>

        <span class="n">priority</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_priority&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">10</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">Task</span><span class="p">):</span>

                <span class="n">task</span> <span class="o">=</span> <span class="n">fn</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">nowait</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">timeout</span><span class="p">)</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()))</span>

                <span class="k">if</span> <span class="n">autospawn</span> <span class="ow">or</span> <span class="n">autospawn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">needs_workers</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">add_worker</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">task</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error in submitting task: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">finally</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">__ACTIVE__</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">__ACTIVE__</span>

    <span class="nd">@staticmethod</span>

    <span class="k">def</span> <span class="nf">as_completed</span><span class="p">(</span><span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Task</span><span class="p">]):</span>

        <span class="k">def</span> <span class="nf">_finished_tasks</span><span class="p">(</span><span class="n">task_item</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">task_item</span> <span class="k">if</span> <span class="n">task_item</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">lengthOfTasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>

        <span class="n">finished_tasks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">finished_tasks</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lengthOfTasks</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">_finished_tasks</span><span class="p">,</span> <span class="n">tasks</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">task</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">finished_tasks</span><span class="p">:</span>

                    <span class="n">finished_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

                    <span class="k">yield</span> <span class="n">task</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">unfinished_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot;+ This calls the &#39;unfinishedTasks&#39; property of PriorityTaskQueue. And is equal to the number of tasks</span>

<span class="sd">            submitted minus the number of times a Task has been Worked by a Worker.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">unfinished_tasks</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">num_queued_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This is a wrapper for the &#39;qsize()&#39; method from PriorityTaskQueue.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">num_active_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_queued_tasks</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">has_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">is_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">has_tasks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot;+ This determines is the Pool both has workers and has work to do. This doesn&#39;t have anything to do with a</span>

<span class="sd">            Pool&#39;s state.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_tasks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">has_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">needs_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_queued_tasks</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">inactive_workers</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">num_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>

            <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">active_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">is_active</span><span class="p">])</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">inactive_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">is_active</span><span class="p">])</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">highest_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">current_priority</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">])</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot;+ This is a protected (wrapped in a lock) List of Workers managed by this pool. &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

    <span class="nd">@workers</span><span class="o">.</span><span class="n">setter</span>

    <span class="k">def</span> <span class="nf">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

    <span class="nd">@workers</span><span class="o">.</span><span class="n">deleter</span>

    <span class="k">def</span> <span class="nf">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot;+ This is a string that has only 4 valid string values that determines the state of the Pool.&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

    <span class="nd">@state</span><span class="o">.</span><span class="n">setter</span>

    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">__THREADPOOL_STATES__</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">__THREADPOOL_STATES__</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid ThreadPool STATE: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

    <span class="nd">@state</span><span class="o">.</span><span class="n">deleter</span>

    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">__INACTIVE__</span>

        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>

            <span class="k">pass</span>

<span class="c1"># noinspection PyUnresolvedReferences</span>

<span class="k">class</span> <span class="nc">MultiEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;MultiEvent&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        Designed to only get set if more the set function is called multiple times.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_counterMax</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_ActionLock</span><span class="p">:</span> <span class="n">Lock</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot; Constructor for the MultiEvent. This requires one parameter named &#39;counter&#39;.</span>

<span class="sd">        - :param counter: (int, default 1) This is how many times &#39;set&#39; method has to be called for the event to be set.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">=</span> <span class="n">counter</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_counterMax</span> <span class="o">=</span> <span class="n">counter</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">MultiEvent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; A wrapper method for &#39;set&#39; in threading&#39;s modules &#39;Event&#39; class. This simply counts down and will attempt</span>

<span class="sd">            to set the Event once the &#39;_counter&#39; is at zero.</span>

<span class="sd">        - :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">-=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

                <span class="nb">super</span><span class="p">(</span><span class="n">MultiEvent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; A wrapper method for &#39;clear&#39; in threading&#39;s modules &#39;Event&#39; class. This resets the &#39;_counter&#39; variable</span>

<span class="sd">            before calling &#39;clear&#39; method of &#39;Event&#39;.</span>

<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counterMax</span>

            <span class="nb">super</span><span class="p">(</span><span class="n">MultiEvent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">remaining_sets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Is a wrapper around the private variable &#39;_counter&#39;.</span>

<span class="sd">        - :return: (int)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span><span class="p">:</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">num_required_sets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counterMax</span>

<span class="k">class</span> <span class="nc">MultipleEvents</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; &lt;a name=&quot;MultipleEvents&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        Designed to take multiple events and put them together to be waited on as a whole.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_events</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Event</span><span class="p">]):</span>

        <span class="sd">&quot;&quot;&quot; Make a new MultipleEvents object using a iterable array of events.</span>

<span class="sd">        - :param events: (a list/tuple/iterable of events)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="n">events</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">MultipleEvents</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">delay</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Wait on all events by using the &#39;is_set&#39; method on each event in the event list.</span>

<span class="sd">        - :param timeout: (int) default is 60. This will not throw an exception it will simply return False.</span>

<span class="sd">        - :param delay: How long to wait between checking if all events have been set.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

        <span class="n">endTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">+</span> <span class="n">timeout</span>

        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">endTime</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isSet</span><span class="p">():</span>

                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">isSet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Uses the &#39;is_set&#39; method on each event in the list and returns True if all is set and False otherwise.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">filter</span><span class="p">(</span><span class="n">MultipleEvents</span><span class="o">.</span><span class="n">wait_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">):</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Reset the internal flag to false on all events.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>

            <span class="n">event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">remove_events</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This deletes all events making this object useless until new events are added.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">add_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This adds a new event to the private variable &#39;_event&#39;. It assumes &#39;_event&#39; is a List object.</span>

<span class="sd">        - :param event: (Event)</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; This is ignored. This object is not meant to set Events simply wait on events.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This set is ignored!&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>

    <span class="k">def</span> <span class="nf">wait_filter</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot; Simply calls and returns &#39;is_set&#39; method of a given Event object.</span>

<span class="sd">        - :param event: (Event)</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
</details>
<h2 id="functions">Functions</h2>
<h3 id="limiter">Limiter</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">Limiter</span><span class="p">(</span>
    <span class="n">num</span><span class="p">,</span>
    <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<p>This is a decorator designed to decorate Threaded and Proccessed decorators to limit the number of</p>
<p>simultaneous calls.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">Limiter</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="n">blocking</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; This is a decorator designed to decorate Threaded and Proccessed decorators to limit the number of</span>

<span class="ss">        simultaneous calls.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">sem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Semaphore</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wrapper</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="nv">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">wrapped</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">blocking</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="nl">sem</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">kwargs</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="s1">&#39;_task_semaphore&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">sem</span><span class="err">}</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">wrapped</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">wrapper</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="dummy_func">dummy_func</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dummy_func</span><span class="p">(</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">dummy_func</span><span class="ss">(</span><span class="o">*</span><span class="nv">args</span>, <span class="o">**</span><span class="nv">kwargs</span><span class="ss">)</span>:

    <span class="k">return</span> <span class="nv">kwargs</span>.<span class="nv">get</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">_default</span><span class="s1">&#39;</span>, <span class="nv">None</span><span class="ss">)</span>
</code></pre></div>

</details>
<h3 id="get_cpu_count">get_cpu_count</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_cpu_count</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;int&#39;</span>
</code></pre></div>

<p>Return the number of Logic CPU Cores on the system</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_cpu_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Return the number of Logic CPU Cores on the system&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">cpu_count</span>

        <span class="k">return</span> <span class="n">cpu_count</span><span class="p">()</span>

    <span class="k">except</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">_DEFAULT_MAX_WORKERS</span>
</code></pre></div>

</details>
<h3 id="method_wait">method_wait</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">method_wait</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="s1">&#39;Callable[..., Any]&#39;</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
    <span class="n">delay</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">delayPercent</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">delayAscending</span><span class="p">:</span> <span class="s1">&#39;Optional[bool]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">incompleteVar</span><span class="p">:</span> <span class="s1">&#39;Optional[bool]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">raiseExc</span><span class="p">:</span> <span class="s1">&#39;Union[bool, Exception]&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<p><a name="method_wait"></a>Allows one to safely wait on a method to return.</p>
<ul>
<li><em>func</em>: (callable) Function to be executed using the method wait</li>
<li><em>timeout</em>: (int, default 60) Amount of time to wait until giving up on the function</li>
<li><em>delay</em>: (int or float, default 0.1) Amount of time to pause inbetween asking the function for results</li>
<li><em>incompleteVar</em>: (any) Variable that indicates the function is not yet finished</li>
<li><em>raiseExc</em>: (bool, default False) Causes methodWait to raise an exception instead of returning None</li>
<li><em>args</em>: args that will be passed to the function</li>
<li><em>kwargs</em>: kwargs that will be passed to the function</li>
<li><em>return</em> could be anything</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">method_wait</span><span class="p">(</span><span class="nl">func</span><span class="p">:</span><span class="w"> </span><span class="n">Callable</span><span class="o">[</span><span class="n">..., Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="nl">delay</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="nl">delayPercent</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="nl">delayAscending</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">incompleteVar</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                </span><span class="nl">raiseExc</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">bool, Exception</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">method_wait</span><span class="ss">&quot;&gt;&lt;/a&gt;Allows one to safely wait on a method to return.</span>

<span class="ss">    - *func*: (callable) Function to be executed using the method wait</span>

<span class="ss">    - *timeout*: (int, default 60) Amount of time to wait until giving up on the function</span>

<span class="ss">    - *delay*: (int or float, default 0.1) Amount of time to pause inbetween asking the function for results</span>

<span class="ss">    - *incompleteVar*: (any) Variable that indicates the function is not yet finished</span>

<span class="ss">    - *raiseExc*: (bool, default False) Causes methodWait to raise an exception instead of returning None</span>

<span class="ss">    - *args*: args that will be passed to the function</span>

<span class="ss">    - *kwargs*: kwargs that will be passed to the function</span>

<span class="ss">    - *return* could be anything</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">ascending_helper</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="n">multipler</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multipler</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">yield</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multipler</span><span class="w"></span>

<span class="w">            </span><span class="n">yield</span><span class="w"> </span><span class="n">ascending_helper</span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multipler</span><span class="p">,</span><span class="w"> </span><span class="n">multipler</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">yield</span><span class="w"> </span><span class="n">num</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delay_ascender</span><span class="p">(</span><span class="n">time_delay</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">time_delay</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="p">.</span><span class="n">pop</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">time_delay</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delay_by_time</span><span class="p">(</span><span class="n">time_delay</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">time_delay</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">time_delay</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">delay_by_percent</span><span class="p">(</span><span class="n">time_delay</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="nf">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">time_delay</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">time_delay</span><span class="w"></span>

<span class="w">    </span><span class="n">rawKwargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>

<span class="w">    </span><span class="n">rawKwargs</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;failureVar&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">delayPercent</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">delayAscending</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">delayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delay_by_percent</span><span class="w"></span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">delayAscending</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">num for num in ascending_helper(timeout, delay)</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">delayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delay_ascender</span><span class="w"></span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">delayAscending</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">num for num in ascending_helper(timeout, delay)</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">delay</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">delayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delay_ascender</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">delayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delay_by_time</span><span class="w"></span>

<span class="w">    </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="k">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;failureVar&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rawKwargs</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">rawKwargs</span><span class="o">[</span><span class="n">&#39;failureVar&#39;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nl">results</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nl">incompleteVar</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delayer</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">incompleteVar</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="w"></span>

<span class="w">    </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The function {func} has thrown an exception. {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: trace for error: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">raiseExc</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">inspect</span><span class="p">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">issubclass</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">,</span><span class="w"> </span><span class="n">BaseException</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">raiseExc</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The function {func} has thrown an exception. {e}&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">raiseExc</span><span class="p">,</span><span class="w"> </span><span class="k">Exception</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">raiseExc</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">incompleteVar</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="safe_acquire">safe_acquire</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">safe_acquire</span><span class="p">(</span>
    <span class="n">lock</span><span class="p">:</span> <span class="s1">&#39;Union[Lock, RLock]&#39;</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Union[int, float]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p><a name="safe_acquire"></a></p>
<p>Meant to be used as a safe way to wait on a lock. Returns False if time runs out.</p>
<ul>
<li>:param lock: (Lock/RLock) the lock that will be acquired or return False</li>
<li>:param timeout: The amount of time to wait on attempting to gain lock.</li>
<li>:return: bools</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">safe_acquire</span><span class="p">(</span><span class="nl">lock</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Lock, RLock</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">safe_acquire</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        Meant to be used as a safe way to wait on a lock. Returns False if time runs out.</span>

<span class="ss">    - :param lock: (Lock/RLock) the lock that will be acquired or return False</span>

<span class="ss">    - :param timeout: The amount of time to wait on attempting to gain lock.</span>

<span class="ss">    - :return: bools</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="k">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;ERROR in safe_acquire with timeout {timeout} : {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for safe_acquire: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="safe_release">safe_release</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">safe_release</span><span class="p">(</span>
    <span class="n">lock</span><span class="p">:</span> <span class="s1">&#39;Union[Lock, RLock]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p><a name="safe_acquire"></a></p>
<p>Meant to be used as a safe way to release a lock. Returns False if the lock has already been released.</p>
<ul>
<li>:param lock: (Lock/RLock) the lock that will be acquired or return False</li>
<li>:return: bools</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">safe_release</span><span class="p">(</span><span class="nl">lock</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Lock, RLock</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;&lt;a name=&quot;</span><span class="n">safe_acquire</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        Meant to be used as a safe way to release a lock. Returns False if the lock has already been released.</span>

<span class="ss">    - :param lock: (Lock/RLock) the lock that will be acquired or return False</span>

<span class="ss">    - :return: bools</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="k">release</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">    </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;ERROR in safe_release: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;[DEBUG] for safe_release: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="wait_lock">wait_lock</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait_lock</span><span class="p">(</span>
    <span class="n">lock</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Union[int, float]&#39;</span><span class="p">,</span>
    <span class="n">blocking</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">raise_exc</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Iterator[bool]&#39;</span>
</code></pre></div>

<p><a name="method_wait"></a></p>
<p>Meant to be used within a 'with' statement to throw an exception when timing out on a lock</p>
<ul>
<li>:param lock: (Lock/RLock/Semephore) the lock that will be acquired or an exception will be thrown</li>
<li>:param timeout: The amount of time to wait on attempting to gain lock.</li>
<li>:return: (generator of bools) This is used with a contextmanager decorator</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="nv">@contextmanager</span><span class="w"></span>

<span class="n">def</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="nl">lock</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">blocking</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">raise_exc</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">method_wait</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        Meant to be used within a &#39;with&#39; statement to throw an exception when timing out on a lock</span>

<span class="ss">    - :param lock: (Lock/RLock/Semephore) the lock that will be acquired or an exception will be thrown</span>

<span class="ss">    - :param timeout: The amount of time to wait on attempting to gain lock.</span>

<span class="ss">    - :return: (generator of bools) This is used with a contextmanager decorator</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span><span class="w"> </span><span class="n">SemLock</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">blocking</span><span class="o">=</span><span class="n">blocking</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nl">raise_exc</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">(</span><span class="ss">&quot;The Lock was unable to be obtained within the timeout: %s&quot;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">yield</span><span class="w"> </span><span class="k">result</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="k">result</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="k">release</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="multievent">MultiEvent</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MultiEvent</span><span class="p">(</span>
    <span class="n">counter</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>class MultiEvent(Event):

    &quot;&quot;&quot; <span class="nt">&lt;a</span> <span class="na">name=</span><span class="s">&quot;MultiEvent&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>

        Designed to only get set if more the set function is called multiple times.

    &quot;&quot;&quot;

    _counter: int = None

    _counterMax: int = None

    _ActionLock: Lock = None

    def __init__(self, counter: int = 1):

        &quot;&quot;&quot; Constructor for the MultiEvent. This requires one parameter named &#39;counter&#39;.

        - :param counter: (int, default 1) This is how many times &#39;set&#39; method has to be called for the event to be set.

        &quot;&quot;&quot;

        self._counter = counter

        self._counterMax = counter

        self._ActionLock = Lock()

        super(MultiEvent, self).__init__()

    def set(self) -&gt; None:

        &quot;&quot;&quot; A wrapper method for &#39;set&#39; in threading&#39;s modules &#39;Event&#39; class. This simply counts down and will attempt

            to set the Event once the &#39;_counter&#39; is at zero.

        - :return: None

        &quot;&quot;&quot;

        with self._ActionLock:

            self._counter -= 1

            if self._counter <span class="err">&lt;</span>= 0:

                super(MultiEvent, self).set()

    def clear(self) -&gt; None:

        &quot;&quot;&quot; A wrapper method for &#39;clear&#39; in threading&#39;s modules &#39;Event&#39; class. This resets the &#39;_counter&#39; variable

            before calling &#39;clear&#39; method of &#39;Event&#39;.

        :return: None

        &quot;&quot;&quot;

        with self._ActionLock:

            self._counter = self._counterMax

            super(MultiEvent, self).clear()

    def remaining_sets(self) -&gt; int:

        &quot;&quot;&quot; Is a wrapper around the private variable &#39;_counter&#39;.

        - :return: (int)

        &quot;&quot;&quot;

        with self._ActionLock:

            return self._counter

    @property

    def num_required_sets(self) -&gt; int:

        return self._counterMax
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>threading.Event</li>
</ul>
<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">num_required_sets</span>
</code></pre></div>

<h4 id="methods">Methods</h4>
<h4 id="clear">clear</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>A wrapper method for 'clear' in threading's modules 'Event' class. This resets the '_counter' variable</p>
<p>before calling 'clear' method of 'Event'.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; A wrapper method for &#39;clear&#39; in threading&#39;s modules &#39;Event&#39; class. This resets the &#39;_counter&#39; variable</span>

<span class="sd">            before calling &#39;clear&#39; method of &#39;Event&#39;.</span>

<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_counterMax</span><span class="w"></span>

<span class="w">            </span><span class="n">super</span><span class="p">(</span><span class="n">MultiEvent</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="isset">isSet</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isSet</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return true if and only if the internal flag is true.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">is_set</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s2">&quot;&quot;&quot;</span><span class="s">Return true if and only if the internal flag is true.</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_flag</span>
</code></pre></div>

</details>
<h4 id="is_set">is_set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_set</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return true if and only if the internal flag is true.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">is_set</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s2">&quot;&quot;&quot;</span><span class="s">Return true if and only if the internal flag is true.</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_flag</span>
</code></pre></div>

</details>
<h4 id="remaining_sets">remaining_sets</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remaining_sets</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;int&#39;</span>
</code></pre></div>

<p>Is a wrapper around the private variable '_counter'.</p>
<ul>
<li>:return: (int)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remaining_sets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Is a wrapper around the private variable &#39;_counter&#39;.</span>

<span class="sd">        - :return: (int)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_ActionLock</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="set">set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>A wrapper method for 'set' in threading's modules 'Event' class. This simply counts down and will attempt</p>
<p>to set the Event once the '_counter' is at zero.</p>
<ul>
<li>:return: None</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; A wrapper method for &#39;</span><span class="nf">set</span><span class="s">&#39; in threading&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="s">&#39;Event&#39;</span><span class="w"> </span><span class="n">class</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">attempt</span><span class="w"></span>

<span class="w">            </span><span class="n">to</span><span class="w"> </span><span class="nf">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">Event</span><span class="w"> </span><span class="n">once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">&#39;_counter&#39;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">zero</span><span class="p">.</span><span class="w"></span>

<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="o">:</span><span class="kr">return</span><span class="o">:</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;</span>

<span class="s">        with self._ActionLock:</span>

<span class="s">            self._counter -= 1</span>

<span class="s">            if self._counter &lt;= 0:</span>

<span class="s">                super(MultiEvent, self).set()</span>
</code></pre></div>

</details>
<h4 id="wait">wait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Block until the internal flag is true.</p>
<p>If the internal flag is true on entry, return immediately. Otherwise,
block until another thread calls set() to set the flag to true, or until
the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof).</p>
<p>This method returns the internal flag on exit, so it will always return
True except if a timeout is given and the operation times out.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">None</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Block until the internal flag is true.</span>

<span class="sd">        If the internal flag is true on entry, return immediately. Otherwise,</span>

<span class="sd">        block until another thread calls set() to set the flag to true, or until</span>

<span class="sd">        the optional timeout occurs.</span>

<span class="sd">        When the timeout argument is present and not None, it should be a</span>

<span class="sd">        floating point number specifying a timeout for the operation in seconds</span>

<span class="sd">        (or fractions thereof).</span>

<span class="sd">        This method returns the internal flag on exit, so it will always return</span>

<span class="sd">        True except if a timeout is given and the operation times out.</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_cond</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">signaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_flag</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">signaled</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">signaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_cond</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">signaled</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="multipleevents">MultipleEvents</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MultipleEvents</span><span class="p">(</span>
    <span class="n">events</span><span class="p">:</span> <span class="s1">&#39;Iterable[Event]&#39;</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">MultipleEvents</span><span class="p">(</span><span class="k">object</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">MultipleEvents</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        Designed to take multiple events and put them together to be waited on as a whole.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">events</span><span class="p">:</span><span class="w"> </span><span class="n">Iterable</span><span class="o">[</span><span class="n">Event</span><span class="o">]</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Make a new MultipleEvents object using a iterable array of events.</span>

<span class="ss">        - :param events: (a list/tuple/iterable of events)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">events</span><span class="w"></span>

<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">MultipleEvents</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="nl">delay</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Wait on all events by using the &#39;is_set&#39; method on each event in the event list.</span>

<span class="ss">        - :param timeout: (int) default is 60. This will not throw an exception it will simply return False.</span>

<span class="ss">        - :param delay: How long to wait between checking if all events have been set.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">list</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nl">endTime</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">isSet</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">isSet</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Uses the &#39;is_set&#39; method on each event in the list and returns True if all is set and False otherwise.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">filter</span><span class="p">(</span><span class="n">MultipleEvents</span><span class="p">.</span><span class="n">wait_filter</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Reset the internal flag to false on all events.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_events</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_events</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This deletes all events making this object useless until new events are added.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">del</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_event</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">event</span><span class="p">:</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This adds a new event to the private variable &#39;_event&#39;. It assumes &#39;_event&#39; is a List object.</span>

<span class="ss">        - :param event: (Event)</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_events</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">set</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is ignored. This object is not meant to set Events simply wait on events.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="ss">&quot;This set is ignored!&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait_filter</span><span class="p">(</span><span class="nl">event</span><span class="p">:</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Simply calls and returns &#39;is_set&#39; method of a given Event object.</span>

<span class="ss">        - :param event: (Event)</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="static-methods">Static methods</h4>
<h4 id="set_1">set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>This is ignored. This object is not meant to set Events simply wait on events.</p>
<ul>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">set</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is ignored. This object is not meant to set Events simply wait on events.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">_log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="ss">&quot;This set is ignored!&quot;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="wait_filter">wait_filter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait_filter</span><span class="p">(</span>
    <span class="n">event</span><span class="p">:</span> <span class="s1">&#39;Event&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Simply calls and returns 'is_set' method of a given Event object.</p>
<ul>
<li>:param event: (Event)</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait_filter</span><span class="p">(</span><span class="nl">event</span><span class="p">:</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Simply calls and returns &#39;is_set&#39; method of a given Event object.</span>

<span class="ss">        - :param event: (Event)</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="methods_1">Methods</h4>
<h4 id="add_event">add_event</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">event</span><span class="p">:</span> <span class="s1">&#39;Event&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>This adds a new event to the private variable '_event'. It assumes '_event' is a List object.</p>
<ul>
<li>:param event: (Event)</li>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">Event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This adds a new event to the private variable &#39;_event&#39;. It assumes &#39;_event&#39; is a List object.</span>

<span class="sd">        - :param event: (Event)</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="clear_1">clear</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Reset the internal flag to false on all events.</p>
<ul>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; Reset the internal flag to false on all events.</span>

<span class="s">        - :return: (None)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">for</span><span class="w"> </span><span class="nf">event</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">_events</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">event</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="isset_1">isSet</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isSet</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Uses the 'is_set' method on each event in the list and returns True if all is set and False otherwise.</p>
<ul>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">isSet</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; Uses the &#39;</span><span class="n">is_set</span><span class="s">&#39; method on each event in the list and returns True if all is set and False otherwise.</span>

<span class="s">        - :return: (bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">MultipleEvents</span><span class="p">.</span><span class="n">wait_filter</span><span class="p">,</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">_events</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">True</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="remove_events">remove_events</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_events</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>This deletes all events making this object useless until new events are added.</p>
<ul>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_events</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This deletes all events making this object useless until new events are added.</span>

<span class="s">        - :return: (None)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">del</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">_events</span><span class="w"></span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="wait_1">wait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
    <span class="n">delay</span><span class="p">:</span> <span class="s1">&#39;Union[int, float]&#39;</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Wait on all events by using the 'is_set' method on each event in the event list.</p>
<ul>
<li>:param timeout: (int) default is 60. This will not throw an exception it will simply return False.</li>
<li>:param delay: How long to wait between checking if all events have been set.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="kr">wait</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="n">delay</span><span class="o">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">float</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; Wait on all events by using the &#39;</span><span class="n">is_set</span><span class="s">&#39; method on each event in the event list.</span>

<span class="s">        - :param timeout: (int) default is 60. This will not throw an exception it will simply return False.</span>

<span class="s">        - :param delay: How long to wait between checking if all events have been set.</span>

<span class="s">        - :return: (bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">type</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">_events</span><span class="p">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">list</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="kd">endT</span><span class="n">ime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="w"></span>

<span class="w">        </span><span class="n">while</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="kd">endT</span><span class="n">ime</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">isSet</span><span class="p">()</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">True</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="kr">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="pool">Pool</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Pool</span><span class="p">(</span>
    <span class="n">workerType</span><span class="p">:</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span>
    <span class="n">maxWorkers</span><span class="p">:</span> <span class="s1">&#39;Optional[int]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="s1">&#39;Optional[Queue]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">daemon</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
    <span class="n">workerAutoKill</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">prepopulate</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">log</span><span class="p">:</span> <span class="s1">&#39;Optional[logging]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Pool</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot; &lt;a name=&quot;ThreadPool&quot;&gt;&lt;/a&gt;</span>

<span class="sd">        This manages a pool of Workers and a queue of Tasks. The workers consume tasks from the taskQueue until they</span>

<span class="sd">        are told to stop.</span>

<span class="sd">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__INACTIVE__</span><span class="w"></span>

<span class="w">    </span><span class="n">__regRLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">    </span><span class="n">__pool_registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">workerType</span><span class="p">:</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">tasks</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Queue</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="n">daemon</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">prepopulate</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">log</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">logging</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">workerType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workerType</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_log</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nb">log</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxWorkers</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">get_cpu_count</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timeout</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RLock</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;workerType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MultiProcRLock</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RLock</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;workerType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MultiProcRLock</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RLock</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">workerType</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;workerType&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;THREAD&#39;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">MultiProcRLock</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">PriorityTaskQueue</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__STARTING__</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">daemon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">daemon</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">ignoredTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">prepopulate</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">setup_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="o">=</span><span class="n">prepopulate</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">elif</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">setup_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"></span>

<span class="w">                                                                    </span><span class="k">else</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">,</span><span class="w"></span>

<span class="w">                               </span><span class="n">workerAutoKill</span><span class="o">=</span><span class="ow">not</span><span class="w"> </span><span class="n">daemon</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">daemon</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">False</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__ACTIVE__</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">exc_type</span><span class="p">,</span><span class="w"> </span><span class="n">exc_val</span><span class="p">,</span><span class="w"> </span><span class="n">exc_tb</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">daemon</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">False</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;ERROR in __exit__ of Pool: {e}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;[DEBUG] for __exit__ of Pool: {traceback.format_exc()}&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Pool(UUID={self.uuid}, State={self._state})&#39;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">setup_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">bool</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                      </span><span class="n">allow_restart</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Generally only used by init. This setups Worker threads to be managed by the Pool.</span>

<span class="sd">        - :param numOfWorkers: (int) Number workers setup. IF the number of workers is higher then the value of</span>

<span class="sd">                &#39;maxWorkers&#39; then &#39;maxWorkers&#39; is updated. The numOfWorkers is how many Workers the Pool has *not* now</span>

<span class="sd">                many new Workers get added.</span>

<span class="sd">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="sd">                the &#39;taskQueue&#39;.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow_restart</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">False</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">set_max_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">elif</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">numOfNewWorkers</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">add_worker</span><span class="p">(</span><span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">,</span><span class="w"></span>

<span class="w">                            </span><span class="n">allow_restart</span><span class="o">=</span><span class="n">allow_restart</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">bool</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">allow_restart</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Adds a single new worker too the Pool.</span>

<span class="sd">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Attempting to add new worker!&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow_restart</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">False</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workerType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">                                                                                       </span><span class="k">else</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="n">Worker</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"></span>

<span class="w">                      </span><span class="n">allow_abandon</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Removes a single new worker from the Pool. This can be called to remove the last Worker or you can</span>

<span class="sd">            specify a Worker to remove.</span>

<span class="sd">        - :param workerTooRemove: (Worker) This is usually sent when a Worker is self terminating</span>

<span class="sd">        - :param timeout: (int) 30, How much time it is willing to wait. NOTE: This is doubled when specifying a</span>

<span class="sd">            worker with the workerTooRemove parameter.</span>

<span class="sd">        - :param allow_abandon: (bool) False, This determines if the thread will simply be abandoned if it cannot</span>

<span class="sd">            normally remove it from the pool. It will only do this if &#39;safe_stop&#39; and &#39;terminate&#39; methods fail.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">wait_time</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">,</span><span class="w"> </span><span class="n">ev</span><span class="p">,</span><span class="w"> </span><span class="n">wtr</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="n">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wait_time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">wtr</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ev</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">wtr</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="o">.</span><span class="n">killed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">workerTooRemove</span><span class="o">.</span><span class="n">safe_stop</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">):</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[WARN]: worker({workerTooRemove}) needs to be terminated in order to be removed.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">getattr</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;terminate&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_func</span><span class="p">)()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">):</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">allow_abandon</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[WARN]: worker({workerTooRemove}) is being abandoned.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">worker</span><span class="o">.</span><span class="n">killed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">True</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">worker</span><span class="o">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">current_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="o">.</span><span class="n">__KILL__</span><span class="p">,</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highest_priority</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">kill</span><span class="o">=</span><span class="n">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                            </span><span class="n">submit_task_autospawn</span><span class="o">=</span><span class="n">False</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">while</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">current_num</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_num</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error occurred while attempting to remove worker: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: Trace for error while attempting to remove worker: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="n">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__INACTIVE__</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_max_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the maximum number of threads that will remain active. Return the maximum thread limit.</span>

<span class="sd">        - :param maxWorkers: (int) Max thread limit</span>

<span class="sd">        - :return: (int)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">maxWorkers</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxWorkers</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait_completion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">],</span><span class="w"> </span><span class="n">delay</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This method waits until all Tasks in the PriorityTaskQueue is done. If the parameter block is True it will</span>

<span class="sd">            stop any new Task from being submitted while waiting.</span>

<span class="sd">        - :param timeout: (int/float) How long to wait for all tasks in the &#39;taskQueue&#39; to be finished.</span>

<span class="sd">        - :param delay: (int/float) The amount of time to wait before checking again in seconds. Default 0.1.</span>

<span class="sd">        - :param block: (bool) This will stop new tasks from being submitted to the Queue until finished.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="n">waitTime</span><span class="p">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">])</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="n">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">waitTime</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">int</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">unsafe</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="p">[</span><span class="nb nb-Type">bool</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This sends a kill operation too all the workers and waits for them to complete and then removes the threads.</span>

<span class="sd">            It can also attempt to kill Workers in an unsafe way with the &#39;terminate&#39; Worker method.</span>

<span class="sd">        - :param timeout: (int) The length of time to wait on tasks to be stopped</span>

<span class="sd">        - :param unsafe: (bool/None) True: The &#39;terminate&#39; method will be called on each Worker. False: Even if the</span>

<span class="sd">                timeout is reached the &#39;terminate&#39; method will *not* be called. None: This will attempt to safely wait</span>

<span class="sd">                for the Workers too finish but if timeout is reached then the &#39;terminate&#39; method will be called.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__STOPPING__</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_clear_helper</span><span class="p">(</span><span class="n">task</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="k">func</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Worker</span><span class="o">.</span><span class="n">__KILL__</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_clear_shutdown_tasks</span><span class="p">():</span><span class="w"></span>

<span class="w">            </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">tasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>

<span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span><span class="w"></span>

<span class="w">                    </span><span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">get</span><span class="p">())</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">_clear_helper</span><span class="p">,</span><span class="w"> </span><span class="n">tasks</span><span class="p">):</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="bp">self</span><span class="o">.</span><span class="n">ignoredTasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error while clearing old tasks: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: Trace for error clearing old tasks: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_unsafe_shutdown</span><span class="p">():</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Worker: {worker} will be killed unsafely.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">worker</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">unsafe</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_unsafe_shutdown</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="n">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;There are no more workers. No need for forced timeout&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">break</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">unsafe</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">_unsafe_shutdown</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">_clear_shutdown_tasks</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This first calls &#39;waitCompletion&#39; with &#39;block=True&#39; and then calls &#39;shutdown&#39;. The goal is to try to wait</span>

<span class="sd">            for all Tasks to complete and then close out the Pool.</span>

<span class="sd">        - :param timeout: (int)The length of time to wait on both join and shutdown.</span>

<span class="sd">        - :return: (bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="nb nb-Type">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">timeout</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="p">:</span><span class="w"> </span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">:</span><span class="w"> </span><span class="n">Tuple</span><span class="p">,</span><span class="w"> </span><span class="n">chunksize</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; A simple mapping tool that takes different params (a List of tuples formatted like [(*args, **kwargs)]) and</span>

<span class="sd">            pass them too a function. chunksize determines how too break up the list and distribute it across Workers.</span>

<span class="sd">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="sd">        - :param params: (Tuple) The Tuple should be formatted like so ( ((arg1, ), {&#39;kwarg1&#39;: &#39;value&#39;}), ...). Each</span>

<span class="sd">                item within the Tuple is a Tuple itself with two items. The first item is positional arguments (args)</span>

<span class="sd">                and the second item is keyword arguments (kwargs). Even if they are empty they need to exist.</span>

<span class="sd">        - :param chunksize: (int) If left at 0 the method will attempt to spread the tasks as evenly as possible.</span>

<span class="sd">                Otherwise it will take the number to mean how many Tasks will be given to a single Worker.</span>

<span class="sd">        - :param kwargs: These are keyword arguments that get passed to the &#39;submit&#39; method.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">chunksize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">chunksize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">chunksize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">chunkHelper</span><span class="p">(</span><span class="k">func</span><span class="p">,</span><span class="w"> </span><span class="n">chunkList</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="k">func</span><span class="p">(</span><span class="o">*</span><span class="n">parms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="o">**</span><span class="n">parms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chunkList</span><span class="p">]</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">listIntoChunks</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">chunksize</span><span class="p">:(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">chunksize</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">((</span><span class="n">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chunksize</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">chunksize</span><span class="p">)]</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">listIntoChunks</span><span class="p">(</span><span class="n">params</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">chunkHelper</span><span class="p">,</span><span class="w"> </span><span class="k">func</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">chunkList</span><span class="o">=</span><span class="n">item</span><span class="p">),</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="p">:</span><span class="w"> </span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">]:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This is the function used to submit a Task to the Pool. Simply provide a function as &#39;fn&#39; and then</span>

<span class="sd">            arguments that need to be passed too that function and it will create a Task and add it to the</span>

<span class="sd">            PriorityTaskQueue to be worked.</span>

<span class="sd">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="sd">        - :param args: These args will be passed to the Task object.</span>

<span class="sd">        - :param kwargs: The following keywords will be pulled out. &#39;submit_task_nowait&#39;, &#39;submit_task_timeout&#39;,</span>

<span class="sd">                &#39;submit_task_autospawn&#39;, &#39;submit_task_priority&#39;. All others will be passed to Task.</span>

<span class="sd">            + &#39;submit_task_nowait&#39;: (bool) tells &#39;submit&#39; to use the &#39;put_nowait&#39; method on PriorityTaskQueue.</span>

<span class="sd">            + &#39;submit_task_timeout&#39;: (int/float) how long should one wait too submit.</span>

<span class="sd">            + &#39;submit_task_autospawn&#39;: (bool/None) determines if new Worker should be spawned because of more tasks.</span>

<span class="sd">            + &#39;submit_task_priority&#39;: (int) changes the priority of the task.</span>

<span class="sd">        - :return: (Task/bool)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">autospawn_parser</span><span class="p">(</span><span class="n">tmpAutospawn</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">__STOPPING__</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">needs_workers</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tmpAutospawn</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">tmpAutospawn</span><span class="w"></span>

<span class="w">        </span><span class="n">nowait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_nowait&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_timeout&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">autospawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">autospawn_parser</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">),</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;submit_task_priority&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="w">        </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">priority</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">nowait</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()))</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">autospawn</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">autospawn</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">needs_workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">add_worker</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="w"></span>

<span class="w">            </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Error in submitting task: {e}</span><span class="se">\n</span><span class="s1">{traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">            </span><span class="n">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">__ACTIVE__</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__ACTIVE__</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">as_completed</span><span class="p">(</span><span class="n">tasks</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="p">[</span><span class="n">Task</span><span class="p">]):</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_finished_tasks</span><span class="p">(</span><span class="n">task_item</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">task_item</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">task_item</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span><span class="w"></span>

<span class="w">        </span><span class="n">lengthOfTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">finished_tasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">finished_tasks</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lengthOfTasks</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">_finished_tasks</span><span class="p">,</span><span class="w"> </span><span class="n">tasks</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">finished_tasks</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">finished_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="nb">yield</span><span class="w"> </span><span class="n">task</span><span class="w"></span>

<span class="w">            </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">unfinished_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;+ This calls the &#39;unfinishedTasks&#39; property of PriorityTaskQueue. And is equal to the number of tasks</span>

<span class="sd">            submitted minus the number of times a Task has been Worked by a Worker.</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">unfinished_tasks</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">num_queued_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; This is a wrapper for the &#39;qsize()&#39; method from PriorityTaskQueue.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">taskQueue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">num_active_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_queued_tasks</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">has_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">unfinished_tasks</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_idle</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">has_tasks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;+ This determines is the Pool both has workers and has work to do. This doesn&#39;t have anything to do with a</span>

<span class="sd">            Pool&#39;s state.</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">has_tasks</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">has_workers</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">has_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">needs_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">num_queued_tasks</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">inactive_workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">False</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">num_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">active_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">len</span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_active</span><span class="p">])</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">inactive_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">len</span><span class="p">([</span><span class="n">i</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_active</span><span class="p">])</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">highest_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">max</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">current_priority</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">])</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">List</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;+ This is a protected (wrapped in a lock) List of Workers managed by this pool. &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">workers</span><span class="o">.</span><span class="n">setter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">workers</span><span class="o">.</span><span class="n">deleter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__workerListLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">__workerList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb">str</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;+ This is a string that has only 4 valid string values that determines the state of the Pool.&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">state</span><span class="o">.</span><span class="n">setter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">__THREADPOOL_STATES__</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__THREADPOOL_STATES__</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="w"></span>

<span class="w">                </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid ThreadPool STATE: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>

<span class="w">    </span><span class="err">@</span><span class="n">state</span><span class="o">.</span><span class="n">deleter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__stateLock</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__INACTIVE__</span><span class="w"></span>

<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">RuntimeError</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">pass</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants">Descendants</h4>
<ul>
<li>PyMultiTasking.ThreadingUtils.ThreadPool</li>
</ul>
<h4 id="static-methods_1">Static methods</h4>
<h4 id="as_completed">as_completed</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">as_completed</span><span class="p">(</span>
    <span class="n">tasks</span><span class="p">:</span> <span class="s1">&#39;List[Task]&#39;</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">as_completed</span><span class="p">(</span><span class="nl">tasks</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">[</span><span class="n">Task</span><span class="o">]</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_finished_tasks</span><span class="p">(</span><span class="n">task_item</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">task_item</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">task_item</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="n">lengthOfTasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">finished_tasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">finished_tasks</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nl">lengthOfTasks</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">filter</span><span class="p">(</span><span class="n">_finished_tasks</span><span class="p">,</span><span class="w"> </span><span class="n">tasks</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">finished_tasks</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">finished_tasks</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">yield</span><span class="w"> </span><span class="n">task</span><span class="w"></span>

<span class="w">            </span><span class="nc">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="instance-variables_1">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">active_workers</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">has_tasks</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">has_workers</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">highest_priority</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">inactive_workers</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">is_active</span>
</code></pre></div>

<ul>
<li>This determines is the Pool both has workers and has work to do. This doesn't have anything to do with a</li>
</ul>
<p>Pool's state.</p>
<div class="codehilite"><pre><span></span><code><span class="n">is_idle</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">needs_workers</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">num_active_tasks</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">num_queued_tasks</span>
</code></pre></div>

<p>This is a wrapper for the 'qsize()' method from PriorityTaskQueue.</p>
<div class="codehilite"><pre><span></span><code><span class="n">num_workers</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">state</span>
</code></pre></div>

<ul>
<li>This is a string that has only 4 valid string values that determines the state of the Pool.</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">unfinished_tasks</span>
</code></pre></div>

<ul>
<li>This calls the 'unfinishedTasks' property of PriorityTaskQueue. And is equal to the number of tasks</li>
</ul>
<p>submitted minus the number of times a Task has been Worked by a Worker.</p>
<div class="codehilite"><pre><span></span><code><span class="n">workers</span>
</code></pre></div>

<ul>
<li>This is a protected (wrapped in a lock) List of Workers managed by this pool. </li>
</ul>
<h4 id="methods_2">Methods</h4>
<h4 id="add_worker">add_worker</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add_worker</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">workerAutoKill</span><span class="p">:</span> <span class="s1">&#39;Optional[bool]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_restart</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Adds a single new worker too the Pool.</p>
<ul>
<li>:param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">add_worker</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">allow_restart</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Adds a single new worker too the Pool.</span>

<span class="ss">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Attempting to add new worker!&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow_restart</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">workerType</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">                                                                                       </span><span class="k">else</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="join">join</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>This first calls 'waitCompletion' with 'block=True' and then calls 'shutdown'. The goal is to try to wait</p>
<p>for all Tasks to complete and then close out the Pool.</p>
<ul>
<li>:param timeout: (int)The length of time to wait on both join and shutdown.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This first calls &#39;</span><span class="n">waitCompletion</span><span class="s">&#39; with &#39;</span><span class="n">block</span><span class="o">=</span><span class="kr">True</span><span class="s">&#39; and then calls &#39;</span><span class="n">shutdown</span><span class="s">&#39;. The goal is to try to wait</span>

<span class="s">            for all Tasks to complete and then close out the Pool.</span>

<span class="s">        - :param timeout: (int)The length of time to wait on both join and shutdown.</span>

<span class="s">        - :return: (bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="kr">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">int</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">timeout</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="map">map</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">map</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fn</span><span class="p">:</span> <span class="s1">&#39;Callable&#39;</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="s1">&#39;Tuple&#39;</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>A simple mapping tool that takes different params (a List of tuples formatted like [(<em>args, </em>*kwargs)]) and</p>
<p>pass them too a function. chunksize determines how too break up the list and distribute it across Workers.</p>
<ul>
<li>:param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</li>
<li>:param params: (Tuple) The Tuple should be formatted like so ( ((arg1, ), {'kwarg1': 'value'}), ...). Each
        item within the Tuple is a Tuple itself with two items. The first item is positional arguments (args)
        and the second item is keyword arguments (kwargs). Even if they are empty they need to exist.</li>
<li>:param chunksize: (int) If left at 0 the method will attempt to spread the tasks as evenly as possible.
        Otherwise it will take the number to mean how many Tasks will be given to a single Worker.</li>
<li>:param kwargs: These are keyword arguments that get passed to the 'submit' method.</li>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="p">:</span><span class="w"> </span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">:</span><span class="w"> </span><span class="n">Tuple</span><span class="p">,</span><span class="w"> </span><span class="n">chunksize</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot; A simple mapping tool that takes different params (a List of tuples formatted like [(*args, **kwargs)]) and</span>

<span class="sd">            pass them too a function. chunksize determines how too break up the list and distribute it across Workers.</span>

<span class="sd">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="sd">        - :param params: (Tuple) The Tuple should be formatted like so ( ((arg1, ), {&#39;kwarg1&#39;: &#39;value&#39;}), ...). Each</span>

<span class="sd">                item within the Tuple is a Tuple itself with two items. The first item is positional arguments (args)</span>

<span class="sd">                and the second item is keyword arguments (kwargs). Even if they are empty they need to exist.</span>

<span class="sd">        - :param chunksize: (int) If left at 0 the method will attempt to spread the tasks as evenly as possible.</span>

<span class="sd">                Otherwise it will take the number to mean how many Tasks will be given to a single Worker.</span>

<span class="sd">        - :param kwargs: These are keyword arguments that get passed to the &#39;submit&#39; method.</span>

<span class="sd">        - :return: (None)</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">kwargs</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;submit_task_autospawn&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">True</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">chunksize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">chunksize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">chunksize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">maxWorkers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">chunkHelper</span><span class="p">(</span><span class="k">func</span><span class="p">,</span><span class="w"> </span><span class="n">chunkList</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="k">func</span><span class="p">(</span><span class="o">*</span><span class="n">parms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="o">**</span><span class="n">parms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chunkList</span><span class="p">]</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">listIntoChunks</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">chunksize</span><span class="p">:(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">chunksize</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">((</span><span class="n">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chunksize</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">chunksize</span><span class="p">)]</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">listIntoChunks</span><span class="p">(</span><span class="n">params</span><span class="p">):</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">chunkHelper</span><span class="p">,</span><span class="w"> </span><span class="k">func</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">chunkList</span><span class="o">=</span><span class="n">item</span><span class="p">),</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="remove_worker">remove_worker</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_worker</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">workerTooRemove</span><span class="p">:</span> <span class="s1">&#39;Optional[Worker]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">allow_abandon</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Removes a single new worker from the Pool. This can be called to remove the last Worker or you can</p>
<p>specify a Worker to remove.</p>
<ul>
<li>:param workerTooRemove: (Worker) This is usually sent when a Worker is self terminating</li>
<li>:param timeout: (int) 30, How much time it is willing to wait. NOTE: This is doubled when specifying a
    worker with the workerTooRemove parameter.</li>
<li>:param allow_abandon: (bool) False, This determines if the thread will simply be abandoned if it cannot
    normally remove it from the pool. It will only do this if 'safe_stop' and 'terminate' methods fail.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">remove_worker</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">workerTooRemove</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Worker</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"></span>

<span class="w">                      </span><span class="nl">allow_abandon</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Removes a single new worker from the Pool. This can be called to remove the last Worker or you can</span>

<span class="ss">            specify a Worker to remove.</span>

<span class="ss">        - :param workerTooRemove: (Worker) This is usually sent when a Worker is self terminating</span>

<span class="ss">        - :param timeout: (int) 30, How much time it is willing to wait. NOTE: This is doubled when specifying a</span>

<span class="ss">            worker with the workerTooRemove parameter.</span>

<span class="ss">        - :param allow_abandon: (bool) False, This determines if the thread will simply be abandoned if it cannot</span>

<span class="ss">            normally remove it from the pool. It will only do this if &#39;safe_stop&#39; and &#39;terminate&#39; methods fail.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">wait_time</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">,</span><span class="w"> </span><span class="n">ev</span><span class="p">,</span><span class="w"> </span><span class="n">wtr</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="k">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">wait_time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">wtr</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">ev</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">wtr</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">.</span><span class="nl">killed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="k">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">workerTooRemove</span><span class="p">.</span><span class="n">safe_stop</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[WARN]: worker({workerTooRemove}) needs to be terminated in order to be removed.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">getattr</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;terminate&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_func</span><span class="p">)()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">wait_helper</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">workerTooRemove</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="nl">allow_abandon</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[WARN]: worker({workerTooRemove}) is being abandoned.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="k">index</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="p">))</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">worker</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">worker</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">current_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">submit</span><span class="p">(</span><span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="p">.</span><span class="n">__KILL__</span><span class="p">,</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">highest_priority</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">kill</span><span class="o">=</span><span class="k">True</span><span class="p">),</span><span class="w"></span>

<span class="w">                            </span><span class="n">submit_task_autospawn</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">while</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nl">current_num</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_num</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error occurred while attempting to remove worker: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: Trace for error while attempting to remove worker: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__INACTIVE__</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="set_max_workers">set_max_workers</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set_max_workers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">maxWorkers</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;int&#39;</span>
</code></pre></div>

<p>Set the maximum number of threads that will remain active. Return the maximum thread limit.</p>
<ul>
<li>:param maxWorkers: (int) Max thread limit</li>
<li>:return: (int)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">set_max_workers</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">maxWorkers</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">int</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; Set the maximum number of threads that will remain active. Return the maximum thread limit.</span>

<span class="s">        - :param maxWorkers: (int) Max thread limit</span>

<span class="s">        - :return: (int)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">type</span><span class="p">(</span><span class="n">maxWorkers</span><span class="p">)</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxWorkers</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">maxWorkers</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="setup_workers">setup_workers</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">setup_workers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">numOfWorkers</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">workerAutoKill</span><span class="p">:</span> <span class="s1">&#39;Optional[bool]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_restart</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>Generally only used by init. This setups Worker threads to be managed by the Pool.</p>
<ul>
<li>:param numOfWorkers: (int) Number workers setup. IF the number of workers is higher then the value of
        'maxWorkers' then 'maxWorkers' is updated. The numOfWorkers is how many Workers the Pool has <em>not</em> now
        many new Workers get added.</li>
<li>:param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in
        the 'taskQueue'.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">setup_workers</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">numOfWorkers</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                      </span><span class="nl">allow_restart</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; Generally only used by init. This setups Worker threads to be managed by the Pool.</span>

<span class="ss">        - :param numOfWorkers: (int) Number workers setup. IF the number of workers is higher then the value of</span>

<span class="ss">                &#39;maxWorkers&#39; then &#39;maxWorkers&#39; is updated. The numOfWorkers is how many Workers the Pool has *not* now</span>

<span class="ss">                many new Workers get added.</span>

<span class="ss">        - :param workerAutoKill: (bool) This determines if the worker ends once their is no longer any work left in</span>

<span class="ss">                the &#39;taskQueue&#39;.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">__STOPPING__</span><span class="p">,</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow_restart</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">maxWorkers</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">set_max_workers</span><span class="p">(</span><span class="n">numOfWorkers</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">maxWorkers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numOfWorkers</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">numOfNewWorkers</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">add_worker</span><span class="p">(</span><span class="n">workerAutoKill</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="p">,</span><span class="w"></span>

<span class="w">                            </span><span class="n">allow_restart</span><span class="o">=</span><span class="n">allow_restart</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">numOfNewWorkers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="shutdown">shutdown</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Optional[int]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unsafe</span><span class="p">:</span> <span class="s1">&#39;Optional[bool]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>This sends a kill operation too all the workers and waits for them to complete and then removes the threads.</p>
<p>It can also attempt to kill Workers in an unsafe way with the 'terminate' Worker method.</p>
<ul>
<li>:param timeout: (int) The length of time to wait on tasks to be stopped</li>
<li>:param unsafe: (bool/None) True: The 'terminate' method will be called on each Worker. False: Even if the
        timeout is reached the 'terminate' method will <em>not</em> be called. None: This will attempt to safely wait
        for the Workers too finish but if timeout is reached then the 'terminate' method will be called.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">shutdown</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">unsafe</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This sends a kill operation too all the workers and waits for them to complete and then removes the threads.</span>

<span class="ss">            It can also attempt to kill Workers in an unsafe way with the &#39;terminate&#39; Worker method.</span>

<span class="ss">        - :param timeout: (int) The length of time to wait on tasks to be stopped</span>

<span class="ss">        - :param unsafe: (bool/None) True: The &#39;terminate&#39; method will be called on each Worker. False: Even if the</span>

<span class="ss">                timeout is reached the &#39;terminate&#39; method will *not* be called. None: This will attempt to safely wait</span>

<span class="ss">                for the Workers too finish but if timeout is reached then the &#39;terminate&#39; method will be called.</span>

<span class="ss">        - :return: (bool)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__STOPPING__</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_clear_helper</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="n">task</span><span class="p">.</span><span class="n">func</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Worker</span><span class="p">.</span><span class="n">__KILL__</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_clear_shutdown_tasks</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">tasks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">tasks</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="k">get</span><span class="p">())</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="n">task_done</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">filter</span><span class="p">(</span><span class="n">_clear_helper</span><span class="p">,</span><span class="w"> </span><span class="n">tasks</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">has_workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">ignoredTasks</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error while clearing old tasks: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: Trace for error clearing old tasks: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_unsafe_shutdown</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">workers</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Worker: {worker} will be killed unsafely.&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">worker</span><span class="p">.</span><span class="k">terminate</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">unsafe</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_unsafe_shutdown</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="k">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;There are no more workers. No need for forced timeout&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">break</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">unsafe</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">_unsafe_shutdown</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">_clear_shutdown_tasks</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="submit">submit</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">submit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fn</span><span class="p">:</span> <span class="s1">&#39;Callable&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Union[Task, bool]&#39;</span>
</code></pre></div>

<p>This is the function used to submit a Task to the Pool. Simply provide a function as 'fn' and then</p>
<p>arguments that need to be passed too that function and it will create a Task and add it to the
    PriorityTaskQueue to be worked.</p>
<ul>
<li>:param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</li>
<li>:param args: These args will be passed to the Task object.</li>
<li>:param kwargs: The following keywords will be pulled out. 'submit_task_nowait', 'submit_task_timeout',
        'submit_task_autospawn', 'submit_task_priority'. All others will be passed to Task.<ul>
<li>'submit_task_nowait': (bool) tells 'submit' to use the 'put_nowait' method on PriorityTaskQueue.</li>
<li>'submit_task_timeout': (int/float) how long should one wait too submit.</li>
<li>'submit_task_autospawn': (bool/None) determines if new Worker should be spawned because of more tasks.</li>
<li>'submit_task_priority': (int) changes the priority of the task.</li>
</ul>
</li>
<li>:return: (Task/bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">submit</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="o">:</span><span class="w"> </span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="n">bool</span><span class="p">]</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This is the function used to submit a Task to the Pool. Simply provide a function as &#39;</span><span class="n">fn</span><span class="s">&#39; and then</span>

<span class="s">            arguments that need to be passed too that function and it will create a Task and add it to the</span>

<span class="s">            PriorityTaskQueue to be worked.</span>

<span class="s">        - :param fn: (Callable) This is something like a function or a partial that will be transformed into a Task</span>

<span class="s">        - :param args: These args will be passed to the Task object.</span>

<span class="s">        - :param kwargs: The following keywords will be pulled out. &#39;</span><span class="n">submit_task_nowait</span><span class="s">&#39;, &#39;</span><span class="n">submit_task_timeout</span><span class="s">&#39;,</span>

<span class="s">                &#39;</span><span class="n">submit_task_autospawn</span><span class="s">&#39;, &#39;</span><span class="n">submit_task_priority</span><span class="s">&#39;. All others will be passed to Task.</span>

<span class="s">            + &#39;</span><span class="n">submit_task_nowait</span><span class="s">&#39;: (bool) tells &#39;</span><span class="n">submit</span><span class="s">&#39; to use the &#39;</span><span class="n">put_nowait</span><span class="s">&#39; method on PriorityTaskQueue.</span>

<span class="s">            + &#39;</span><span class="n">submit_task_timeout</span><span class="s">&#39;: (int/float) how long should one wait too submit.</span>

<span class="s">            + &#39;</span><span class="n">submit_task_autospawn</span><span class="s">&#39;: (bool/None) determines if new Worker should be spawned because of more tasks.</span>

<span class="s">            + &#39;</span><span class="n">submit_task_priority</span><span class="s">&#39;: (int) changes the priority of the task.</span>

<span class="s">        - :return: (Task/bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">autospawn_parser</span><span class="p">(</span><span class="n">tmpAutospawn</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">__STOPPING__</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">__STOPPED__</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">needs_workers</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">tmpAutospawn</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">True</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="n">tmpAutospawn</span><span class="w"></span>

<span class="w">        </span><span class="n">nowait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;submit_task_nowait&#39;</span><span class="p">,</span><span class="w"> </span><span class="kr">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;submit_task_timeout&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">autospawn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">autospawn_parser</span><span class="p">(</span><span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;submit_task_autospawn&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">),</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">state</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="kr">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;submit_task_priority&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="w">        </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="w"></span>

<span class="w">            </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="kr">priority</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">try</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="n">nowait</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">self</span><span class="p">.</span><span class="n">taskQueue</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="nf">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()))</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="n">autospawn</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="n">autospawn</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">needs_workers</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">self</span><span class="p">.</span><span class="n">add_worker</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="n">task</span><span class="w"></span>

<span class="w">            </span><span class="kr">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="n">f</span><span class="s">&#39;Error in submitting task: {e}\n{traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>

<span class="w">            </span><span class="n">finally</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">state</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">__ACTIVE__</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">self</span><span class="p">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__ACTIVE__</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="wait_completion">wait_completion</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait_completion</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Union[int, float]&#39;</span><span class="p">,</span>
    <span class="n">delay</span><span class="p">:</span> <span class="s1">&#39;Union[int, float]&#39;</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">block</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<p>This method waits until all Tasks in the PriorityTaskQueue is done. If the parameter block is True it will</p>
<p>stop any new Task from being submitted while waiting.</p>
<ul>
<li>:param timeout: (int/float) How long to wait for all tasks in the 'taskQueue' to be finished.</li>
<li>:param delay: (int/float) The amount of time to wait before checking again in seconds. Default 0.1.</li>
<li>:param block: (bool) This will stop new tasks from being submitted to the Queue until finished.</li>
<li>:return: (bool)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait_completion</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">float</span><span class="p">],</span><span class="w"> </span><span class="n">delay</span><span class="o">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">float</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">False</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This method waits until all Tasks in the PriorityTaskQueue is done. If the parameter block is True it will</span>

<span class="s">            stop any new Task from being submitted while waiting.</span>

<span class="s">        - :param timeout: (int/float) How long to wait for all tasks in the &#39;</span><span class="n">taskQueue</span><span class="s">&#39; to be finished.</span>

<span class="s">        - :param delay: (int/float) The amount of time to wait before checking again in seconds. Default 0.1.</span>

<span class="s">        - :param block: (bool) This will stop new tasks from being submitted to the Queue until finished.</span>

<span class="s">        - :return: (bool)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Event</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="n">waitTime</span><span class="o">:</span><span class="w"> </span><span class="n">Union</span><span class="p">[</span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">float</span><span class="p">])</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">while</span><span class="w"> </span><span class="n">current_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">waitTime</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">has_workers</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">unfinished_tasks</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">return</span><span class="w"> </span><span class="kr">True</span><span class="w"></span>

<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="kr">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">current_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">False</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">block</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">__taskLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="p">.</span><span class="n">monotonic</span><span class="p">()))</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">_wait_completion</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="prioritytaskqueue">PriorityTaskQueue</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PriorityTaskQueue</span><span class="p">(</span>
    <span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">PriorityTaskQueue</span><span class="p">(</span><span class="n">PriorityQueue</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">PriorityTaskQueue</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        This is a simple override of the PriorityQueue class that ensures the &#39;item&#39; is a Task class meant to be used</span>

<span class="ss">        ONLY in ThreadingPool</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put_nowait</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="nl">block</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float, None</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>queue.PriorityQueue</li>
<li>queue.Queue</li>
</ul>
<h4 id="methods_3">Methods</h4>
<h4 id="empty">empty</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">empty</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return True if the queue is empty, False otherwise (not reliable!).</p>
<p>This method is likely to be removed at some point.  Use qsize() == 0
as a direct substitute, but be aware that either approach risks a race
condition where a queue can grow before the result of empty() or
qsize() can be used.</p>
<p>To create code that needs to wait for all queued tasks to be
completed, the preferred technique is to use the join() method.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">empty</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Return True if the queue is empty, False otherwise (not reliable!).</span>

        <span class="nv">This</span> <span class="nv">method</span> <span class="nv">is</span> <span class="nv">likely</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">removed</span> <span class="nv">at</span> <span class="nv">some</span> <span class="nv">point</span>.  <span class="nv">Use</span> <span class="nv">qsize</span><span class="ss">()</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="nv">as</span> <span class="nv">a</span> <span class="nv">direct</span> <span class="nv">substitute</span>, <span class="nv">but</span> <span class="nv">be</span> <span class="nv">aware</span> <span class="nv">that</span> <span class="nv">either</span> <span class="nv">approach</span> <span class="nv">risks</span> <span class="nv">a</span> <span class="nv">race</span>

        <span class="nv">condition</span> <span class="nv">where</span> <span class="nv">a</span> <span class="nv">queue</span> <span class="nv">can</span> <span class="nv">grow</span> <span class="nv">before</span> <span class="nv">the</span> <span class="nb">result</span> <span class="nv">of</span> <span class="nv">empty</span><span class="ss">()</span> <span class="nv">or</span>

        <span class="nv">qsize</span><span class="ss">()</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">used</span>.

        <span class="nv">To</span> <span class="nv">create</span> <span class="nv">code</span> <span class="nv">that</span> <span class="nv">needs</span> <span class="nv">to</span> <span class="k">wait</span> <span class="k">for</span> <span class="nv">all</span> <span class="nv">queued</span> <span class="nv">tasks</span> <span class="nv">to</span> <span class="nv">be</span>

        <span class="nv">completed</span>, <span class="nv">the</span> <span class="nv">preferred</span> <span class="nv">technique</span> <span class="nv">is</span> <span class="nv">to</span> <span class="nv">use</span> <span class="nv">the</span> <span class="nv">join</span><span class="ss">()</span> <span class="nv">method</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">mutex</span>:

            <span class="k">return</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="full">full</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">full</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return True if the queue is full, False otherwise (not reliable!).</p>
<p>This method is likely to be removed at some point.  Use qsize() &gt;= n
as a direct substitute, but be aware that either approach risks a race
condition where a queue can shrink before the result of full() or
qsize() can be used.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">full</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Return True if the queue is full, False otherwise (not reliable!).</span>

        <span class="nv">This</span> <span class="nv">method</span> <span class="nv">is</span> <span class="nv">likely</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">removed</span> <span class="nv">at</span> <span class="nv">some</span> <span class="nv">point</span>.  <span class="nv">Use</span> <span class="nv">qsize</span><span class="ss">()</span> <span class="o">&gt;=</span> <span class="nv">n</span>

        <span class="nv">as</span> <span class="nv">a</span> <span class="nv">direct</span> <span class="nv">substitute</span>, <span class="nv">but</span> <span class="nv">be</span> <span class="nv">aware</span> <span class="nv">that</span> <span class="nv">either</span> <span class="nv">approach</span> <span class="nv">risks</span> <span class="nv">a</span> <span class="nv">race</span>

        <span class="nv">condition</span> <span class="nv">where</span> <span class="nv">a</span> <span class="nv">queue</span> <span class="nv">can</span> <span class="nv">shrink</span> <span class="nv">before</span> <span class="nv">the</span> <span class="nb">result</span> <span class="nv">of</span> <span class="nv">full</span><span class="ss">()</span> <span class="nv">or</span>

        <span class="nv">qsize</span><span class="ss">()</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">used</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">mutex</span>:

            <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nv">self</span>.<span class="nv">maxsize</span> <span class="o">&lt;=</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="get">get</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove and return an item from the queue.</p>
<p>If optional args 'block' is true and 'timeout' is None (the default),
block if necessary until an item is available. If 'timeout' is
a non-negative number, it blocks at most 'timeout' seconds and raises
the Empty exception if no item was available within that time.
Otherwise ('block' is false), return an item if one is immediately
available, else raise the Empty exception ('timeout' is ignored
in that case).</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">get</span><span class="ss">(</span><span class="nv">self</span>, <span class="nv">block</span><span class="o">=</span><span class="nv">True</span>, <span class="nb">timeout</span><span class="o">=</span><span class="nv">None</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Remove and return an item from the queue.</span>

        <span class="k">If</span> <span class="nv">optional</span> <span class="nv">args</span> <span class="s1">&#39;</span><span class="s">block</span><span class="s1">&#39;</span> <span class="nv">is</span> <span class="nv">true</span> <span class="nv">and</span> <span class="s1">&#39;</span><span class="s">timeout</span><span class="s1">&#39;</span> <span class="nv">is</span> <span class="nv">None</span> <span class="ss">(</span><span class="nv">the</span> <span class="nv">default</span><span class="ss">)</span>,

        <span class="nv">block</span> <span class="k">if</span> <span class="nv">necessary</span> <span class="k">until</span> <span class="nv">an</span> <span class="nv">item</span> <span class="nv">is</span> <span class="nv">available</span>. <span class="k">If</span> <span class="s1">&#39;</span><span class="s">timeout</span><span class="s1">&#39;</span> <span class="nv">is</span>

        <span class="nv">a</span> <span class="nv">non</span><span class="o">-</span><span class="nv">negative</span> <span class="nv">number</span>, <span class="nv">it</span> <span class="nv">blocks</span> <span class="nv">at</span> <span class="nv">most</span> <span class="s1">&#39;</span><span class="s">timeout</span><span class="s1">&#39;</span> <span class="nv">seconds</span> <span class="nv">and</span> <span class="nv">raises</span>

        <span class="nv">the</span> <span class="nv">Empty</span> <span class="nv">exception</span> <span class="k">if</span> <span class="nv">no</span> <span class="nv">item</span> <span class="nv">was</span> <span class="nv">available</span> <span class="nv">within</span> <span class="nv">that</span> <span class="nv">time</span>.

        <span class="nv">Otherwise</span> <span class="ss">(</span><span class="s1">&#39;</span><span class="s">block</span><span class="s1">&#39;</span> <span class="nv">is</span> <span class="nv">false</span><span class="ss">)</span>, <span class="k">return</span> <span class="nv">an</span> <span class="nv">item</span> <span class="k">if</span> <span class="nv">one</span> <span class="nv">is</span> <span class="nv">immediately</span>

        <span class="nv">available</span>, <span class="k">else</span> <span class="nv">raise</span> <span class="nv">the</span> <span class="nv">Empty</span> <span class="nv">exception</span> <span class="ss">(</span><span class="s1">&#39;</span><span class="s">timeout</span><span class="s1">&#39;</span> <span class="nv">is</span> <span class="nv">ignored</span>

        <span class="nv">in</span> <span class="nv">that</span> <span class="nv">case</span><span class="ss">)</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">not_empty</span>:

            <span class="k">if</span> <span class="nv">not</span> <span class="nv">block</span>:

                <span class="k">if</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>:

                    <span class="nv">raise</span> <span class="nv">Empty</span>

            <span class="nv">elif</span> <span class="nb">timeout</span> <span class="nv">is</span> <span class="nv">None</span>:

                <span class="k">while</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>:

                    <span class="nv">self</span>.<span class="nv">not_empty</span>.<span class="k">wait</span><span class="ss">()</span>

            <span class="nv">elif</span> <span class="nb">timeout</span> <span class="o">&lt;</span> <span class="mi">0</span>:

                <span class="nv">raise</span> <span class="nv">ValueError</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">&#39;timeout&#39; must be a non-negative number</span><span class="s2">&quot;</span><span class="ss">)</span>

            <span class="k">else</span>:

                <span class="nv">endtime</span> <span class="o">=</span> <span class="nv">time</span><span class="ss">()</span> <span class="o">+</span> <span class="nb">timeout</span>

                <span class="k">while</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>:

                    <span class="nv">remaining</span> <span class="o">=</span> <span class="nv">endtime</span> <span class="o">-</span> <span class="nv">time</span><span class="ss">()</span>

                    <span class="k">if</span> <span class="nv">remaining</span> <span class="o">&lt;=</span> <span class="mi">0</span>.<span class="mi">0</span>:

                        <span class="nv">raise</span> <span class="nv">Empty</span>

                    <span class="nv">self</span>.<span class="nv">not_empty</span>.<span class="k">wait</span><span class="ss">(</span><span class="nv">remaining</span><span class="ss">)</span>

            <span class="nv">item</span> <span class="o">=</span> <span class="nv">self</span>.<span class="nv">_get</span><span class="ss">()</span>

            <span class="nv">self</span>.<span class="nv">not_full</span>.<span class="nv">notify</span><span class="ss">()</span>

            <span class="k">return</span> <span class="nv">item</span>
</code></pre></div>

</details>
<h4 id="get_nowait">get_nowait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_nowait</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove and return an item from the queue without blocking.</p>
<p>Only get an item if one is immediately available. Otherwise
raise the Empty exception.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">get_nowait</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Remove and return an item from the queue without blocking.</span>

        <span class="nv">Only</span> <span class="nv">get</span> <span class="nv">an</span> <span class="nv">item</span> <span class="k">if</span> <span class="nv">one</span> <span class="nv">is</span> <span class="nv">immediately</span> <span class="nv">available</span>. <span class="nv">Otherwise</span>

        <span class="nv">raise</span> <span class="nv">the</span> <span class="nv">Empty</span> <span class="nv">exception</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">block</span><span class="o">=</span><span class="nv">False</span><span class="ss">)</span>
</code></pre></div>

</details>
<h4 id="join_1">join</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Blocks until all items in the Queue have been gotten and processed.</p>
<p>The count of unfinished tasks goes up whenever an item is added to the
queue. The count goes down whenever a consumer thread calls task_done()
to indicate the item was retrieved and all work on it is complete.</p>
<p>When the count of unfinished tasks drops to zero, join() unblocks.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">join</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Blocks until all items in the Queue have been gotten and processed.</span>

        <span class="nv">The</span> <span class="nv">count</span> <span class="nv">of</span> <span class="nv">unfinished</span> <span class="nv">tasks</span> <span class="nv">goes</span> <span class="nv">up</span> <span class="nv">whenever</span> <span class="nv">an</span> <span class="nv">item</span> <span class="nv">is</span> <span class="nv">added</span> <span class="nv">to</span> <span class="nv">the</span>

        <span class="nv">queue</span>. <span class="nv">The</span> <span class="nv">count</span> <span class="nv">goes</span> <span class="nv">down</span> <span class="nv">whenever</span> <span class="nv">a</span> <span class="nv">consumer</span> <span class="nv">thread</span> <span class="nv">calls</span> <span class="nv">task_done</span><span class="ss">()</span>

        <span class="nv">to</span> <span class="nv">indicate</span> <span class="nv">the</span> <span class="nv">item</span> <span class="nv">was</span> <span class="nv">retrieved</span> <span class="nv">and</span> <span class="nv">all</span> <span class="nv">work</span> <span class="nv">on</span> <span class="nv">it</span> <span class="nv">is</span> <span class="nv">complete</span>.

        <span class="nv">When</span> <span class="nv">the</span> <span class="nv">count</span> <span class="nv">of</span> <span class="nv">unfinished</span> <span class="nv">tasks</span> <span class="nv">drops</span> <span class="nv">to</span> <span class="nv">zero</span>, <span class="nv">join</span><span class="ss">()</span> <span class="nv">unblocks</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">all_tasks_done</span>:

            <span class="k">while</span> <span class="nv">self</span>.<span class="nv">unfinished_tasks</span>:

                <span class="nv">self</span>.<span class="nv">all_tasks_done</span>.<span class="k">wait</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="put">put</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">put</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">item</span><span class="p">:</span> <span class="s1">&#39;Task&#39;</span><span class="p">,</span>
    <span class="n">block</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Union[int, float, None]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Put an item into the queue.</p>
<p>If optional args 'block' is true and 'timeout' is None (the default),
block if necessary until a free slot is available. If 'timeout' is
a non-negative number, it blocks at most 'timeout' seconds and raises
the Full exception if no free slot was available within that time.
Otherwise ('block' is false), put an item on the queue if a free slot
is immediately available, else raise the Full exception ('timeout'
is ignored in that case).</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="nl">block</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float, None</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="put_nowait">put_nowait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">put_nowait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">item</span><span class="p">:</span> <span class="s1">&#39;Task&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Put an item into the queue without blocking.</p>
<p>Only enqueue the item if a free slot is immediately available.
Otherwise raise the Full exception.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put_nowait</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="qsize">qsize</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">qsize</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return the approximate size of the queue (not reliable!).</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">qsize</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Return the approximate size of the queue (not reliable!).</span><span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">mutex</span>:

            <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_qsize</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="task_done">task_done</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">task_done</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Indicate that a formerly enqueued task is complete.</p>
<p>Used by Queue consumer threads.  For each get() used to fetch a task,
a subsequent call to task_done() tells the queue that the processing
on the task is complete.</p>
<p>If a join() is currently blocking, it will resume when all items
have been processed (meaning that a task_done() call was received
for every item that had been put() into the queue).</p>
<p>Raises a ValueError if called more times than there were items
placed in the queue.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">task_done</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s1">&#39;&#39;&#39;</span><span class="s">Indicate that a formerly enqueued task is complete.</span>

        <span class="nv">Used</span> <span class="nv">by</span> <span class="nv">Queue</span> <span class="nv">consumer</span> <span class="nv">threads</span>.  <span class="k">For</span> <span class="nv">each</span> <span class="nv">get</span><span class="ss">()</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">fetch</span> <span class="nv">a</span> <span class="nv">task</span>,

        <span class="nv">a</span> <span class="nv">subsequent</span> <span class="k">call</span> <span class="nl">to</span> <span class="nv">task_done</span><span class="ss">()</span> <span class="nv">tells</span> <span class="nv">the</span> <span class="nv">queue</span> <span class="nv">that</span> <span class="nv">the</span> <span class="nv">processing</span>

        <span class="nv">on</span> <span class="nv">the</span> <span class="nv">task</span> <span class="nv">is</span> <span class="nv">complete</span>.

        <span class="k">If</span> <span class="nv">a</span> <span class="nv">join</span><span class="ss">()</span> <span class="nv">is</span> <span class="nv">currently</span> <span class="nv">blocking</span>, <span class="nv">it</span> <span class="nv">will</span> <span class="nv">resume</span> <span class="nv">when</span> <span class="nv">all</span> <span class="nv">items</span>

        <span class="nv">have</span> <span class="nv">been</span> <span class="nv">processed</span> <span class="ss">(</span><span class="nv">meaning</span> <span class="nv">that</span> <span class="nv">a</span> <span class="nv">task_done</span><span class="ss">()</span> <span class="k">call</span> <span class="nl">was</span> <span class="nv">received</span>

        <span class="k">for</span> <span class="nv">every</span> <span class="nv">item</span> <span class="nv">that</span> <span class="nv">had</span> <span class="nv">been</span> <span class="nv">put</span><span class="ss">()</span> <span class="nv">into</span> <span class="nv">the</span> <span class="nv">queue</span><span class="ss">)</span>.

        <span class="nv">Raises</span> <span class="nv">a</span> <span class="nv">ValueError</span> <span class="k">if</span> <span class="nv">called</span> <span class="nv">more</span> <span class="nv">times</span> <span class="nv">than</span> <span class="nv">there</span> <span class="nv">were</span> <span class="nv">items</span>

        <span class="nv">placed</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">queue</span>.

        <span class="s1">&#39;&#39;&#39;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">all_tasks_done</span>:

            <span class="nv">unfinished</span> <span class="o">=</span> <span class="nv">self</span>.<span class="nv">unfinished_tasks</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nv">unfinished</span> <span class="o">&lt;=</span> <span class="mi">0</span>:

                <span class="k">if</span> <span class="nv">unfinished</span> <span class="o">&lt;</span> <span class="mi">0</span>:

                    <span class="nv">raise</span> <span class="nv">ValueError</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">task_done() called too many times</span><span class="s1">&#39;</span><span class="ss">)</span>

                <span class="nv">self</span>.<span class="nv">all_tasks_done</span>.<span class="nv">notify_all</span><span class="ss">()</span>

            <span class="nv">self</span>.<span class="nv">unfinished_tasks</span> <span class="o">=</span> <span class="nv">unfinished</span>
</code></pre></div>

</details>
<h3 id="processtaskqueue">ProcessTaskQueue</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ProcessTaskQueue</span><span class="p">(</span>
    <span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">ctx</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">ProcessTaskQueue</span><span class="p">(</span><span class="n">JoinableQueue</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">ProcessTaskQueue</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        This is a simple override of the JoinableQueue class that ensures the &#39;item&#39; is a Task class meant to be used</span>

<span class="ss">        ONLY in ProcessingPool</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">ProcessTaskQueue</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="n">maxsize</span><span class="p">,</span><span class="w"> </span><span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">multiprocessing</span><span class="p">.</span><span class="n">get_context</span><span class="p">())</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put_nowait</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="nl">block</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float, None</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_2">Ancestors (in MRO)</h4>
<ul>
<li>multiprocessing.queues.JoinableQueue</li>
<li>multiprocessing.queues.Queue</li>
</ul>
<h4 id="methods_4">Methods</h4>
<h4 id="cancel_join_thread">cancel_join_thread</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">cancel_join_thread</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    def cancel_join_thread(self):

        debug(&#39;Queue.cancel_join_thread()&#39;)

        self._joincancelled = True

        try:

            self._jointhread.cancel()

        except AttributeError:

            pass
</code></pre></div>

</details>
<h4 id="close">close</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">close</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="nv">self</span>.<span class="nv">_closed</span> <span class="o">=</span> <span class="nv">True</span>

        <span class="nv">try</span>:

            <span class="nv">self</span>.<span class="nv">_reader</span>.<span class="nv">close</span><span class="ss">()</span>

        <span class="nv">finally</span>:

            <span class="nv">close</span> <span class="o">=</span> <span class="nv">self</span>.<span class="nv">_close</span>

            <span class="k">if</span> <span class="nv">close</span>:

                <span class="nv">self</span>.<span class="nv">_close</span> <span class="o">=</span> <span class="nv">None</span>

                <span class="nv">close</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="empty_1">empty</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">empty</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">empty</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="k">return</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_poll</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="full_1">full</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">full</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">full</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_sem</span>.<span class="nv">_semlock</span>.<span class="nv">_is_zero</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="get_1">get</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">None</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_closed</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Queue {self!r} is closed&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">with</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_rlock</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_recv_bytes</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="bp">self</span><span class="o">.</span><span class="n">_sem</span><span class="o">.</span><span class="n">release</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">deadline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">timeout</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_rlock</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">Empty</span><span class="w"></span>

<span class="w">            </span><span class="n">try</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">block</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deadline</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">):</span><span class="w"></span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">Empty</span><span class="w"></span>

<span class="w">                </span><span class="k">elif</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_poll</span><span class="p">():</span><span class="w"></span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">Empty</span><span class="w"></span>

<span class="w">                </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_recv_bytes</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">_sem</span><span class="o">.</span><span class="n">release</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="bp">self</span><span class="o">.</span><span class="n">_rlock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="c1"># unserialize the data after having released the lock</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_ForkingPickler</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="get_nowait_1">get_nowait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_nowait</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">get_nowait</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">False</span><span class="ss">)</span>
</code></pre></div>

</details>
<h4 id="join_2">join</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">join</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">_cond</span>:

            <span class="k">if</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_unfinished_tasks</span>.<span class="nv">_semlock</span>.<span class="nv">_is_zero</span><span class="ss">()</span>:

                <span class="nv">self</span>.<span class="nv">_cond</span>.<span class="k">wait</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="join_thread">join_thread</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">join_thread</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">join_thread</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="nv">debug</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">Queue.join_thread()</span><span class="s1">&#39;</span><span class="ss">)</span>

        <span class="nv">assert</span> <span class="nv">self</span>.<span class="nv">_closed</span>, <span class="s2">&quot;</span><span class="s">Queue {0!r} not closed</span><span class="s2">&quot;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>

        <span class="k">if</span> <span class="nv">self</span>.<span class="nv">_jointhread</span>:

            <span class="nv">self</span>.<span class="nv">_jointhread</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="put_1">put</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">put</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">item</span><span class="p">:</span> <span class="s1">&#39;Task&#39;</span><span class="p">,</span>
    <span class="n">block</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="s1">&#39;Union[int, float, None]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="nl">block</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">timeout</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">int, float, None</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="put_nowait_1">put_nowait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">put_nowait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">item</span><span class="p">:</span> <span class="s1">&#39;Task&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">put_nowait</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">item</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: item is not a Task object cannot be put into PriorityTaskQueue&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="qsize_1">qsize</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">qsize</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">qsize</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        # <span class="nv">Raises</span> <span class="nv">NotImplementedError</span> <span class="nv">on</span> <span class="nv">Mac</span> <span class="nv">OSX</span> <span class="nv">because</span> <span class="nv">of</span> <span class="nv">broken</span> <span class="nv">sem_getvalue</span><span class="ss">()</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_maxsize</span> <span class="o">-</span> <span class="nv">self</span>.<span class="nv">_sem</span>.<span class="nv">_semlock</span>.<span class="nv">_get_value</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="task_done_1">task_done</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">task_done</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">task_done</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">_cond</span>:

            <span class="k">if</span> <span class="nv">not</span> <span class="nv">self</span>.<span class="nv">_unfinished_tasks</span>.<span class="nv">acquire</span><span class="ss">(</span><span class="nv">False</span><span class="ss">)</span>:

                <span class="nv">raise</span> <span class="nv">ValueError</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">task_done() called too many times</span><span class="s1">&#39;</span><span class="ss">)</span>

            <span class="k">if</span> <span class="nv">self</span>.<span class="nv">_unfinished_tasks</span>.<span class="nv">_semlock</span>.<span class="nv">_is_zero</span><span class="ss">()</span>:

                <span class="nv">self</span>.<span class="nv">_cond</span>.<span class="nv">notify_all</span><span class="ss">()</span>
</code></pre></div>

</details>
<h3 id="task">Task</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Task</span><span class="p">(</span>
    <span class="n">fn</span><span class="p">:</span> <span class="s1">&#39;Callable&#39;</span><span class="p">,</span>
    <span class="n">priority</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">kill</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inject_task</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">store_return</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_queue</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">callback_func</span><span class="p">:</span> <span class="s1">&#39;Optional[Callable]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">semaphore</span><span class="p">:</span> <span class="s1">&#39;Optional[Semaphore]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">Event</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">Task</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">        This is a wrapper class that inherits from an Event Object and is used inside the Worker.</span>

<span class="ss">        It is designed to hold the function ran and save the results of the function.</span>

<span class="ss">    &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="nl">defaultriority</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">fn</span><span class="p">:</span><span class="w"> </span><span class="n">Callable</span><span class="p">,</span><span class="w"> </span><span class="nl">priority</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">kill</span><span class="err">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="nl">inject_task</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="nl">store_return</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">ignore_queue</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="nl">callback_func</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Callable</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="nl">semaphore</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Semaphore</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">kwargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kwargs</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">priority</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">kill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">kill</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">ignore_queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ignore_queue</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">callback_func</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">semaphore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="k">partial</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">inject_task</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Task</span><span class="p">.</span><span class="n">__inspect_kwargs</span><span class="p">(</span><span class="n">fn</span><span class="p">.</span><span class="n">func</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">fn</span><span class="p">.</span><span class="n">keywords</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="s1">&#39;TaskObject&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="err">}</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">inject_task</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Task</span><span class="p">.</span><span class="n">__inspect_kwargs</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">kwargs</span><span class="p">.</span><span class="k">update</span><span class="p">(</span><span class="err">{</span><span class="s1">&#39;TaskObject&#39;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="err">}</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">partial</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">.</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">self</span><span class="p">.</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">store_return</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store_return</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MultiProcRLock</span><span class="p">()</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">run</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is used to run the stored partial function and store the results.</span>

<span class="ss">        - :param args: Positional arguments to be passed to the task.</span>

<span class="ss">        - :param kwargs: Keyword arguments to be passed to the task</span>

<span class="ss">        - :return: (Anything)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="k">Exception</span><span class="p">(</span><span class="s1">&#39;A Task Object cannot be ran more than once!&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">semaphore</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">store_return</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">callback_fun</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">results</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">callback_fun</span><span class="p">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{self} failed&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{self} succeeded&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="k">set</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">semaphore</span><span class="p">.</span><span class="k">release</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">store_return</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">results</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="k">Exception</span><span class="p">(</span><span class="s1">&#39;A Task Object cannot be cleared once set!&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__inspect_kwargs</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="o">=</span><span class="s1">&#39;TaskObject&#39;</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">[</span><span class="n">key for key in inspect.signature(func).parameters.keys() if keyword == key or &#39;kwargs&#39; == key</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__hash__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">hash</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">uuid</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Task(UUID={self.uuid},Priority={self.priority}): {self.task.func}&#39;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__gt__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">priority</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__lt__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">priority</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__ge__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">priority</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__le__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">priority</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">worker</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">acquired</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">acquired</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__worker</span><span class="w"></span>

<span class="w">    </span><span class="nv">@worker</span><span class="p">.</span><span class="n">setter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">worker</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="w"></span>

<span class="w">    </span><span class="nv">@worker</span><span class="p">.</span><span class="n">deleter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">worker</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">del</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__worker</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">False</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">acquired</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">acquired</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__results</span><span class="w"></span>

<span class="w">    </span><span class="nv">@results</span><span class="p">.</span><span class="n">setter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="w"></span>

<span class="w">    </span><span class="nv">@results</span><span class="p">.</span><span class="n">deleter</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">results</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">wait_lock</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__updateRLock</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">raise_exc</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">del</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__results</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_3">Ancestors (in MRO)</h4>
<ul>
<li>threading.Event</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">defaultriority</span>
</code></pre></div>

<h4 id="instance-variables_2">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">results</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">worker</span>
</code></pre></div>

<h4 id="methods_5">Methods</h4>
<h4 id="clear_2">clear</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Reset the internal flag to false.</p>
<p>Subsequently, threads calling wait() will block until set() is called to
set the internal flag to true again.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&#39;A Task Object cannot be cleared once set!&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">Task</span><span class="p">,</span><span class="w"> </span><span class="kr">self</span><span class="p">).</span><span class="n">clear</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="isset_2">isSet</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isSet</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return true if and only if the internal flag is true.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">is_set</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s2">&quot;&quot;&quot;</span><span class="s">Return true if and only if the internal flag is true.</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_flag</span>
</code></pre></div>

</details>
<h4 id="is_set_1">is_set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">is_set</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Return true if and only if the internal flag is true.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">is_set</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s2">&quot;&quot;&quot;</span><span class="s">Return true if and only if the internal flag is true.</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nv">self</span>.<span class="nv">_flag</span>
</code></pre></div>

</details>
<h4 id="run">run</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<p>This is used to run the stored partial function and store the results.</p>
<ul>
<li>:param args: Positional arguments to be passed to the task.</li>
<li>:param kwargs: Keyword arguments to be passed to the task</li>
<li>:return: (Anything)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">run</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Any</span><span class="o">:</span><span class="w"></span>

<span class="w">        </span><span class="s">&quot;&quot;&quot; This is used to run the stored partial function and store the results.</span>

<span class="s">        - :param args: Positional arguments to be passed to the task.</span>

<span class="s">        - :param kwargs: Keyword arguments to be passed to the task</span>

<span class="s">        - :return: (Anything)</span>

<span class="s">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">is_set</span><span class="p">()</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&#39;A Task Object cannot be ran more than once!&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">try</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">semaphore</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">store_return</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">self</span><span class="p">.</span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">results</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">callback_fun</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span><span class="w"></span>

<span class="w">                </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">                    </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="kr">except</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s">&#39;{self} failed&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">e</span><span class="w"></span>

<span class="w">        </span><span class="n">else</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="n">_log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s">&#39;{self} succeeded&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">finally</span><span class="o">:</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">semaphore</span><span class="p">.</span><span class="n">release</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">store_return</span><span class="o">:</span><span class="w"></span>

<span class="w">                </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">results</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="set_2">set</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>Set the internal flag to true.</p>
<p>All threads waiting for it to become true are awakened. Threads
that call wait() once the flag is true will not block at all.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    <span class="nv">def</span> <span class="nv">set</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:

        <span class="s2">&quot;&quot;&quot;</span><span class="s">Set the internal flag to true.</span>

        <span class="nv">All</span> <span class="nv">threads</span> <span class="nv">waiting</span> <span class="k">for</span> <span class="nv">it</span> <span class="nv">to</span> <span class="nv">become</span> <span class="nv">true</span> <span class="nv">are</span> <span class="nv">awakened</span>. <span class="nv">Threads</span>

        <span class="nv">that</span> <span class="k">call</span> <span class="nl">wait</span><span class="ss">()</span> <span class="nv">once</span> <span class="nv">the</span> <span class="nv">flag</span> <span class="nv">is</span> <span class="nv">true</span> <span class="nv">will</span> <span class="nv">not</span> <span class="nv">block</span> <span class="nv">at</span> <span class="nv">all</span>.

        <span class="s2">&quot;&quot;&quot;</span>

        <span class="nv">with</span> <span class="nv">self</span>.<span class="nv">_cond</span>:

            <span class="nv">self</span>.<span class="nv">_flag</span> <span class="o">=</span> <span class="nv">True</span>

            <span class="nv">self</span>.<span class="nv">_cond</span>.<span class="nv">notify_all</span><span class="ss">()</span>
</code></pre></div>

</details>
<h4 id="wait_2">wait</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Block until the internal flag is true.</p>
<p>If the internal flag is true on entry, return immediately. Otherwise,
block until another thread calls set() to set the flag to true, or until
the optional timeout occurs.</p>
<p>When the timeout argument is present and not None, it should be a
floating point number specifying a timeout for the operation in seconds
(or fractions thereof).</p>
<p>This method returns the internal flag on exit, so it will always return
True except if a timeout is given and the operation times out.</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="o">=</span><span class="n">None</span><span class="p">):</span><span class="w"></span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Block until the internal flag is true.</span>

<span class="sd">        If the internal flag is true on entry, return immediately. Otherwise,</span>

<span class="sd">        block until another thread calls set() to set the flag to true, or until</span>

<span class="sd">        the optional timeout occurs.</span>

<span class="sd">        When the timeout argument is present and not None, it should be a</span>

<span class="sd">        floating point number specifying a timeout for the operation in seconds</span>

<span class="sd">        (or fractions thereof).</span>

<span class="sd">        This method returns the internal flag on exit, so it will always return</span>

<span class="sd">        True except if a timeout is given and the operation times out.</span>

<span class="sd">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">with</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_cond</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">signaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_flag</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">signaled</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">signaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_cond</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">signaled</span><span class="w"></span>
</code></pre></div>

</details>
<h3 id="worker">Worker</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Worker</span><span class="p">(</span>
    <span class="n">pool</span><span class="p">:</span> <span class="s1">&#39;Optional[Pool]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">workerAutoKill</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">defaultTimeout</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">personalQue</span><span class="p">:</span> <span class="s1">&#39;Optional[ProcessTaskQueue]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="s1">&#39;Optional[Callable]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Optional[str]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">daemon</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">log</span><span class="p">:</span> <span class="s1">&#39;Optional[logging]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">Worker</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot; &lt;a name=&quot;</span><span class="n">Worker</span><span class="ss">&quot;&gt;&lt;/a&gt;</span>

<span class="ss">            This is designed to be managed by a ThreadPool. However, it can run on its own as well. It runs until told to</span>

<span class="ss">            stop and works tasks that come from a the PriorityTaskQueue maintained by the Pool.</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">    </span><span class="n">__defaultTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="w">    </span><span class="n">workerType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">pool</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Pool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">workerAutoKill</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">defaultTimeout</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="nl">personalQue</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">ProcessTaskQueue</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">target</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Callable</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"></span>

<span class="w">                 </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">daemon</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nf">log</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">logging</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">())</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_log</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nf">log</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__defaultTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultTimeout</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultTimeout</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">personalQue</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">Task</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="k">kill</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">ignore_queue</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">Worker</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">uuid</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">daemon</span><span class="o">=</span><span class="n">daemon</span><span class="p">,</span><span class="w"></span>

<span class="w">                                     </span><span class="n">args</span><span class="o">=</span><span class="n">kwargs</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s1">&#39;args&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()),</span><span class="w"> </span><span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s1">&#39;kwargs&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">{}</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pool</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workerAutoKill</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">pool</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[INFO]: Starting new {self}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="k">start</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="s1">&#39;Worker: {self.name if self.name == self.uuid else f&quot;{self.name}-{self.uuid}&quot;} for Pool: {self.pool}&#39;</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__hash__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">hash</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">uuid</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">safe_stop</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">noinspection</span><span class="w"> </span><span class="n">PyUnresolvedReferences</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_next_task</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Task, bool, None</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This gets the next Task in the taskQueue</span>

<span class="ss">        - :return: (Task)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_target</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_target</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="k">kill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">ignore_queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">Empty</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">timeout</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="p">.</span><span class="n">__KILL__</span><span class="p">,</span><span class="w"> </span><span class="k">kill</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">ignore_queue</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error in getting task: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: trace for error in getting task: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">run</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is an override of the run method within Thread that loops constantly waiting on another task.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">killed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_next_task</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;task is None an error occurred in get_next_task method closing the thread&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">break</span><span class="w"></span>

<span class="w">                </span><span class="n">elif</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The task is: {task}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">self</span><span class="p">.</span><span class="n">_args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">self</span><span class="p">.</span><span class="n">_kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="nl">ignore_queue</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">.</span><span class="n">task_done</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="k">kill</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Killing thread once task is complete: {task}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: While Worker thread is running with task: {self.__currentTask} Error: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: trace for error: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">isSet</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="k">set</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="nl">ignore_queue</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;task_done&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_func</span><span class="p">)()</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="p">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="o">=</span><span class="n">self</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="nv">@staticmethod</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__KILL__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">pass</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">task_queue</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pool&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;taskQueue&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">timeout</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This property will return 0 if it thinks it doesn&#39;t need to run any longer and is ready to self terminate</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">__workerAutoKill</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"></span>

<span class="w">                                        </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="p">.</span><span class="n">num_workers</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="p">.</span><span class="n">maxWorkers</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="w"> </span><span class="o">//=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__defaultTimeout</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">__timeout</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__defaultTimeout</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">current_priority</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This changes to the priority of each incoming task. &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">__currentTask</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">priority</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;ERROR: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="w">    </span><span class="nv">@property</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_active</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This determines if the Worker currently has a Task to work. &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"></span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants_1">Descendants</h4>
<ul>
<li>PyMultiTasking.ThreadingUtils.ThreadWorker</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">workerType</span>
</code></pre></div>

<h4 id="instance-variables_3">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">current_priority</span>
</code></pre></div>

<p>This changes to the priority of each incoming task. </p>
<div class="codehilite"><pre><span></span><code><span class="n">is_active</span>
</code></pre></div>

<p>This determines if the Worker currently has a Task to work. </p>
<div class="codehilite"><pre><span></span><code><span class="n">task_queue</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">timeout</span>
</code></pre></div>

<p>This property will return 0 if it thinks it doesn't need to run any longer and is ready to self terminate</p>
<h4 id="methods_6">Methods</h4>
<h4 id="get_next_task">get_next_task</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_task</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Union[Task, bool, None]&#39;</span>
</code></pre></div>

<p>This gets the next Task in the taskQueue</p>
<ul>
<li>:return: (Task)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_next_task</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Task, bool, None</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This gets the next Task in the taskQueue</span>

<span class="ss">        - :return: (Task)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_target</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_target</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="k">kill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">ignore_queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__personalQue</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">__timeout</span><span class="p">)</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">worker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">Empty</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">timeout</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">Task</span><span class="p">(</span><span class="n">Worker</span><span class="p">.</span><span class="n">__KILL__</span><span class="p">,</span><span class="w"> </span><span class="k">kill</span><span class="o">=</span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="n">ignore_queue</span><span class="o">=</span><span class="k">True</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: Error in getting task: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: trace for error in getting task: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">None</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="run_1">run</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>This is an override of the run method within Thread that loops constantly waiting on another task.</p>
<ul>
<li>:return: (None)</li>
</ul>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">run</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot; This is an override of the run method within Thread that loops constantly waiting on another task.</span>

<span class="ss">        - :return: (None)</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">killed</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_next_task</span><span class="p">()</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;task is None an error occurred in get_next_task method closing the thread&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="k">break</span><span class="w"></span>

<span class="w">                </span><span class="n">elif</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">False</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The task is: {task}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">task</span><span class="p">(</span><span class="o">*</span><span class="n">self</span><span class="p">.</span><span class="n">_args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">self</span><span class="p">.</span><span class="n">_kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="nl">ignore_queue</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">.</span><span class="n">task_done</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="k">kill</span><span class="err">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Killing thread once task is complete: {task}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">                        </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="k">Exception</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[ERROR]: While Worker thread is running with task: {self.__currentTask} Error: {e}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="nf">log</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;[DEBUG]: trace for error: {traceback.format_exc()}&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="n">isSet</span><span class="p">()</span><span class="err">:</span><span class="w"></span>

<span class="w">                    </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="k">set</span><span class="p">()</span><span class="w"></span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="p">.</span><span class="nl">ignore_queue</span><span class="p">:</span><span class="w"></span>

<span class="w">                        </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">task_queue</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;task_done&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_func</span><span class="p">)()</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">__currentTask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w"></span>

<span class="w">        </span><span class="nl">finally</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">True</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">killed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">pool</span><span class="p">.</span><span class="n">remove_worker</span><span class="p">(</span><span class="n">workerTooRemove</span><span class="o">=</span><span class="n">self</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

</details>
<h4 id="safe_stop">safe_stop</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">safe_stop</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code>    def safe_stop(self):

        self.killed = True
</code></pre></div>

</details>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../" title="Index" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Index
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>